---
title: "Early environment and numerical discrimination in a lizard"
docx: 
  reference-doc: "./bib/tmpl.docx"
bibliography: "./bib/refs.bib"
csl: "./bib/behavioral-ecology-and-sociobiology.csl"
execute:
  echo: false
  error: false
  cache: false
  warning: false
link-citations: true
crossref:  
  fig-title: Fig    # (default is "Figure")
  title-delim: —     # (default is ":")
  fig-prefix: Fig.   # (default is "Figure")
  tbl-prefix: Table  # (default is "Table")
editor_options: 
  chunk_output_type: console
---

```{r, packages}
#| label: packages
pacman::p_load(tidyverse, flextable, emmeans, DHARMa, brms, here, ggplot2, lme4, zoo, lmerTest, broom, tidybayes, forcats, MASS,
fitdistrplus, ggh4x, PupillometryR, cowplot, png, grid, remotes, ggthemes)
```

Pablo Recio^1^,$\ddagger$ , Dalton C. Leibold^1^, Ondi L. Crino ^1,2^, Christopher R. Friesen^3^, Amelia Y. Peardon ^1^, Daniel W.A. Noble^1^

^1^ Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra, ACT 2601, Australia  
^2^ Flinder's University, College of Science and Engineering, Bedford Park, SA 5042, Australia  
^3^ University of Wollongong, Wollongong, NSW 2500, Australia  
$\ddagger$ Corresponding author: pablo.reciosantiago@anu.edu.au  

ORCID:

Pablo Recio ORCID: 0000-0002-5890-0218  
Dalton C. Leibold ORCID: 0000-0001-9645-2033  
Ondi L. Crino ORCID: 0000-0001-5700-1387  
Christopher R. Friesen ORCID: 0000-0001-5338-7454  
Amelia Y. Peardon ORCID: 0009-0005-6227-8379  
Daniel W.A. Noble ORCID: 0000-0001-9460-8743

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

## Keywords
Numerical discrimination, Corticosterone, Temperature, Reptiles, Early life stress, Cognitive abilities 

## Abstract
From social behaviour to navigating their environment, quantitative abilities can be crucial in animals' life. Early life conditions are predicted to impact brain development, and quantitative competence may not be exent of these effects. Early thermal environment or glucocorticoids (GCs) - stress-related hormones - transmitted by the parents can play a prominent role in shaping cognition through effects on brain physiology. Furthermore, temperature can lead to increased levels of GCs that are passed on to the offspring, emphasizing the need to study the combined effects of these two factors. Here, we investigated the effects of prenatal corticosterone (CORT) - the main GC in reptiles - and incubation temperature on numerical discrimination in the common garden skink (_Lampropholis guichenoti_). We manipulated CORT levels and temperature during incubation and then assessed numerical abilities through a spontaneous choice test with food as the relevant stimulus. Employing a repeated measures design, we subjected lizards to five numerical tests each differing in the total number of items and the ratios between the two choices (1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 2 VS 4). Contrary to our expectations, we found no evidence of numerical discrimination or any effect of treatments on lizards' behaviour. These findings suggest that _L. guichenoti_ may not use numerical cues to make foraging decisions and that early conditions do not affect their behaviour towards different quantities of food.  

## Significance statement
Discriminating between quantities is crucial for animal behaviour, yet the impact of early environmental factors on the development of quantitative competence remains largely unexplored. In this study, we investigated for the first time the effects of prenatal corticosterone exposure and incubation temperature on numerical discrimination in a reptile. Contrary to our predictions, we did not observe any evidence of numerical discrimination regardless of incubation conditions. Our results align with previous studies showing that reptiles consuming live prey struggle to differentiate prey numbers in spontaneous choice tests. These results open new avenues for exploring the evolution of numerical abilities in reptiles and identifying factors influencing the development of quantitative skills in this group. Further research should explore alternative methods, such as trained tasks, to better understand the cognitive mechanisms underlying quantitative competence in reptiles.  

## Introduction  
The ability to discern between quantities is a fundamental cognitive skill widely observed across the animal kingdom [@stancher2015numerical; @vonk2012bears; @beran2016capuchin]. Numerical cognition is adaptive in various ecological contexts, contributing to social decisions, mate selection, or foraging [@lucon2017individual; @nieder2018evolution]. For instance, female lions (_Panthera leo_) use numerical information to assess the risk of confronting rival groups [@mccomb1994roaring], male adult mealworms (_Tenebrio molitor_) select sites with scents of more females [@carazo2009quantity], and red-backed salamanders (_Plethodon cinereus_) prefer tubes containing larger numbers of prey [@uller2003salamanders]. Given the adaptive advantages of numerical and quantity discrimination, research has extensively explored the ability of different species to differentiate between quantities under different contexts and paradigms.  

Numerical competence is often evaluated by considering the types of cues animals use [@plotnik2019elephants; @cooper2024tell], the ecological contexts in which these abilities are deployed [@mccomb1994roaring; @chittka1995can; @uller2003salamanders; @carazo2009quantity], and the neural mechanisms that underlie them [@nieder2005counting]. The latter have demonstrated that non-verbal numerical representations in mammals activate an extensive cortical network, with the prefrontal cortex and the intraparietal sulcus being particularly relevant [@nieder2005counting]. This connection between numerosity and brain physiology underscores the importance of understanding how brain development influences numerical abilities.  

Animals' brains are particularly sensitive to environmental inputs during early stages of development [@coomber_independent_1997; @zhu_prenatal_2004], with long-lasting effects on cognitive abilities [@zhu_prenatal_2004; @amiel_egg_2014]. For instance, glucocorticoids (GCs), the main groups of hormones mediating the physiological stress response [@sapolsky_how_2000], can alter animals' performance in spatial, associative, or reversal learning tasks if elevated during early stages of development [@szuran_water_1994; @zhu_prenatal_2004; @crino_corticosterone_2014-learn; @farrell_developmental_2015-learn; @bebus_associative_2016; @lui2017chronic]. Prenatal exposure to GCs is typically associated with impaired learning skills, but these effects have been shown to vary depending on factors such as dose, subjects' sex, or type of cognitive test employed [@szuran_water_1994; @farrell_developmental_2015-learn; @bebus_associative_2016; @haq_prenatal_2021]. Nevertheless, little is known about how exposure to GCs during development can affect quantitative abilities. 

At the same time, the early thermal environment plays a prominent role in brain development and cognitive abilities in ectotherms [@coomber_independent_1997;@amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @vila_pouca_incubation_2018; @vila_pouca_quantity_2019]. For example, Port-Jackson sharks (_Heterodontus portusjacksoni_) incubated at elevated temperatures learned faster in a quantity discrimination task [@vila_pouca_quantity_2019]. However, the effects of early thermal environment on numerical abilities in other taxa remains largely unexplored.  

Given that abrupt temperature changes can increase GC levels in vertebrates, leading to elevated GCs transmitted to the offspring [@racic_effects_2020; @Crino_2023], it is essential to study the combined effects of early-life GCs and thermal conditions on cognitive development. Understanding how these factors influence quantitative abilities could reveal important insights into the ecological relevance of numerosity. To fill this gap, we used the common garden skink (_Lampropholis guichenoti_) as a model to test the effects of elevated prenatal corticosterone (CORT) - the main GC in reptiles [@Crino_2023] - and incubation temperature on numerical discrimination abilities.  

Traditionally, research on numerical abilities has been mainly focused on mammals, birds, and fishes [@nieder2005counting; @agrillo2014spontaneous], but recent studies demonstrate that reptiles are also competent in numberical abilities. For example, red-footed turtles (_Chelonoidis carbonaria_) rapidly learned to associate colour with higher volumes of food [@soldati2017long], Hermann’s tortoises (_Testudo hermanni_) proved to discriminate between large and small food quantities in a spontaneous choice test [@gazzola2018continuous], and freshwater turtles (_Trachemys scripta_ and _Mauremys sinensis_) rapidly learned a quantity discrimination task [@lin2021superior; @lin2024trained]. The italian wall lizard (_Podarcis siculus_) failed to discriminate between different numbers of food items in a spontaneous choice test [@miletto2017quantitative], but succeeded in a trained quantity discrimination task [@miletto2018quantity]. In contrast, Iberian rock lizards (_Iberolacerta cyreni_) preferred larger quantities of crickets when presented five versus ten items [@recio_prey_2021]. Indeed, the literature shows evidence for basic quantitative abilities in reptiles that may vary with the type of cue and the test employed.  

Reptiles' cognition is significantly influenced by the environment in which they develop. For example, incubating lizards at elevated temperatures improves cognitive abilities consistent with elevated neuronal density in some areas of the brain [@amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017], but impairs cognition at temperatures above lizards’ natural incubation thermal range [@dayananda_incubation_2017; @abayarathna_effects_2020]. The effects of prenatal CORT on cognitive abilities in reptiles is less understood, but in other taxa, high levels of GCs are typically related to cognitive impairments [@szuran_water_1994; @zhu_prenatal_2004]. However, the combined influence of prenatal CORT and thermal environment on cognition remains unknown, particularly on numerical abilities.   

Our study aimed to address this question by manipulating CORT concentration (CORT-treated or a sham control) in _L. guichenoti_ eggs and incubating them under one of two temperature regimes (Cold - 23 ± 3ºC or Hot - 28 ± 3ºC) in a 2x2 factorial design. After hatching, we assessed the lizards' numerical discrimination abilities in a spontaneous choice test, where they were presented with different numbers of crickets. Based on other studies that explored the cognitive effects of prenatal GCs or thermal early environment in reptiles and other taxa, we hypothesized that lizards incubated at higher temperatures would outperform those incubated at lower temperatures in the numerical discrimination task [@amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @vila_pouca_quantity_2019]. Additionally, we predicted that increased CORT levels would impair numerical competence [@szuran_water_1994; @zhu_prenatal_2004], with more pronounced effects at lower temperatures. In this sense, a common observation in nature is that the ability to detect a change in stimulus intensity depends on the relative, not absolute, difference between the stimuli ['Weber's law'; @agrillo2014spontaneous]. Consistent with Weber's law, we predicted that lizards incubated at higher temperatures would successfully discriminate between quantities even at high ratios (e.g. 3 VS 4), whereas even the lowest ratios (e.g. 1 VS 4) could be challenging for those exposed to CORT or incubated at lower temperatures.  

## Methods  

#### Animal husbandry  
*Breeding colony* -- The lizards tested in our experiment came from a breeding colony established in the lab in 2019. The colony consisted of approximately 180 adults of _L. guichenoti_ housed in communal containers (41.5 L x 30.5 W x 21 H cm) with six lizards (2 males and 4 females) per enclosure. Enclosures were provided with non-stick matting, shelter, and several small water dishes filled daily, and lizards were fed mid-size crickets (*Acheta domestica*) three days a week. Crickets were dusted with calcium weekly and multivitamins and calcium biweekly. Room temperatures were set to 22-24ºC, but to ensure a temperature gradient, we employed a heat chord and a heat lamp following a 12 h light:12 h dark cycle, keeping the warm side of enclosures at 32-34ºC.  

*Egg collection and incubation* -- Between mid-October 2023 to the end of February 2024, we placed small boxes (12.5 L x 8.3 W x 5 H cm) containing vermiculite on one side of the communal enclosures (see above) to provide females with a place to lay the eggs. We checked for eggs in the boxes three days a week. Eggs' length and width were measured with a digital calliper to the nearest mm (± 0.1 mm), while mass was recorded with a digital scale (OHAUS, Model spx123) to the nearest g (± 0.001 g). Eggs were assigned a clutch number and an individual identity. Then we treated eggs with CORT or vehicle (see CORT and Temperature manipulation below) and placed them in individual cups (80 mL) with moist vermiculite (12 g water to 4 g vermiculite). We covered the cups with plastic wrap to retain moisture and left the eggs in incubators (LATWIT 2X5D-R1160) programmed to two different thermal regimes (see CORT and Temperature manipulation below) until hatching. Incubators were checked for the presence of hatchlings three times a week.  

*Hatchlings* -- Immediately after hatching, we measured Snout-Vent Length (SVL) and Tail Length (TL) with a ruler to the nearest mm (± 0.1 mm), and mass using a digital scale (OHAUS, Model spx123) to the nearest g (± 0.001 g). Hatchlings were then placed in individual enclosures (18.7L x 13.2W x 6.3H cm) provided with non-stick matting and a small water dish. During this period, they were given water daily and received 3-6 small *A. domestica* crickets three times a week. All care otherwise follows similar protocols to adults (see above).  


#### Manipulating Early Thermal and CORT Environments  

We manipulated CORT concentration in eggs and incubated them under one of two temperature regimes (Cold -- 23 ± 3ºC or Hot -- 30 ± 3ºC) in a 2x2 factorial design (@fig-Methods A). Eggs were allocated to one of two different developmental stress treatments: CORT-treated eggs were topically supplied with 5µL of CORT dissolved in 100% Ethanol at a final concentration of 10 pg CORT/mL. In the Control treatment eggs received an equal volume of the 100% Ethanol vehicle. We selected those doses based on previous studies where CORT treatment increased mean yolk CORT levels ~3.7x higher than control eggs in _Lampropholis delicata_ [@crino2024eggs]. Then, eggs were incubated in one of the two previously mentioned temperature regimes (Cold or Hot) until hatching. These temperatures represent the upper and lower limit of the natural incubation temperatures for this species [@qualls2000post]. The number of eggs per clutch assigned to each hormone and temperature treatment was counterbalanced per clutch.  

#### Numerical discrimination task  

Two weeks before starting the numerical discrimination task (see below), lizards were moved to the experimental arenas for acclimatisation. The arenas were individual medium-size (41 L x 29.7 W x 22 H cm) plastic containers provided with a shelter (9 L x 6 W x 1.5 H cm) on one of the sides and a water dish in the center (@fig-Methods B). These arenas were placed in 7 different racks located in two experimental rooms. Each rack was associated with its own CCTV system (device model DVR-HP210475), allowing us to record lizards' behaviour during the experiment. Despite the conditions in the experimental rooms were the same as in the colony room, we counterbalanced the number of lizards per treatment in each rack to control for any potential effects of the room or the position of the lizard in the rack. During acclimatisation and throughout the experiment, lizards were fed with only one cricket daily, dusted with calcium and multivitamins (see protocol below), and water was supplied *ad libitum*. The temperature of both rooms was set to 22-24ºC, but we also provided a temperature gradient (24-32°C) using a heat cord along the center of the arena and heat lamps in a 12 h light: 12 h dark cycle.  

The numerical discrimination test consisted of a series of two-choice trials where lizards were presented with different numbers of food items. Each choice was placed on one of the two lateral platforms of a white 3D printed device (see @fig-Methods B, C) and then covered with a transparent Petri dish to prevent the lizard from obtaining the food. We performed five tests that differed in the ratio between both choices: 1 cricket VS 4 crickets, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4. The food consisted of small frozen crickets (*A. domestica*) that were thawed and dusted with calcium and multivitamins. We decided to use frozen crickets to avoid movement that would affect lizards' behaviour [@cooper2024tell]. 

Lizards were fed frozen crickets for one month prior to the experiments to habituate them to eating frozen prey. To habituate lizards to the experimental conditions, frozen crickets were placed on top of one of the platforms and Petri dishes during each feeding for two weeks prior to experimental trials. The side where the food was placed was changed every day to avoid any side bias during the trials. However, to further control for that, the side where we placed the higher number of crickets was randomised between trials and individuals during the tests. We also counterbalanced the number of individuals per treatment tested in the same type of trial each day. The crickets used during the experiment were all the same size, but to control for other quantitative traits [@agrillo2014spontaneous], we changed the orientation of the crickets as shown in @fig-Methods D. In addition, after the experiments, we conducted another set of trials to test whether the orientation of the crickets could affect lizards’ choice, but we found no effect of orientation (see Supplementary Material - Prey orientation test).  

```{r, fig-Methods}
#| label: fig-Methods
#| fig.cap: "Experimental design of the study. Panel (**A**) shows the early environment manipulation procedures. (**B**) illustrates the arena where the tests were performed, while panel (**C**) indicates the measurements of the platform used for the experiments. Finally, panel (**D**) displays the types of numerical tests used and the orientation of the crickets in each test."

knitr::include_graphics("./Others/NUMDIS_FIG_1.png")

```

All tests were done between 1000-1200 hours when the lizards were most active. Each trial was performed daily for five days between the 17^th^ and 22^nd^ of May 2024. We recorded three main variables: i) Latency, defined as the time between the start of the test - when the platform was left in the enclosure - until the first interaction with one of the options; ii) First choice of the lizard (Choice), recorded as 1 if the lizard interacted first with the larger amount or 0 if not; and iii) Interest shown for the higher amount of food (detailed below). We considered that the lizard interacted with the food when it touched the Petri dish with its snout or when the front half of the body was on top of the platform. For five minutes after the first interaction with one of the options, we recorded the time spent interacting with that option for a maximum of five minutes; we did this for both amounts of food independently of what was the first choice. We measured the interest shown for the higher amount of food (Interest) by substracting the time interacting with the option with fewer crickets to the time spent interacting with the larger amount of food. If there was no interaction with one of the options during the test, we considered the time spent as 0 for that option. When there was no interaction with any of the choices, both Latency, Choice, and Interest were noted as NA. We also considered Interest as NA in a few cases where the animals managed to lift the dish and eat the prey; Latency and Choice were recorded and employed in the analyses. We excluded from the analyses all the individuals that did not make any choice in three or more tests.   


#### Statistical analyses  
In our analyses, we fitted a multivariate Bayesian multilevel model using the brm function from the _brms_ package [@burkner2017brms] in R extension (version 2.8.2) [@R]. We ran four parallel MCMC chains of 3000 iterations for each model, with a warmup period of 1000 iterations. We checked that all MCMC chains converged (Rhat < 1.2) and were mixing effectively to ensure we had >1000 effective samples from the posterior distribution.   

We modelled the three main recorded behaviours: Latency, Choice, and Interest as the response variables. We assumed normal distributions for Latency (log-transformed) and Interest [family = gaussian()]. The error structure for Choice was modeled using a Bernoulli distribution with a logit link function [family = Bernoulli(link = ‘logit’)].  We included test (1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4), hormone (CORT versus Control), incubation temperature (Cold versus Hot), and the three-way interaction as fixed factors. We also included in our predictors sex, and age (centered to 0). We included lizard identity and clutch as random factors. _L. guichenoti_ lays up to two clutches per year [@joss1985reproductive]. Since egg collection was done during half of the breeding season, each clutch likely came from a unique mother, and so, clutch identity captures potential maternal effects.  

We used the posterior distributions of parameters from these models to test for between treatment differences in the ability to discriminate different numbers of crickets for each of the numerical tests. We used p~mcmc~ to tests whether the contrast between treatments for each test differed from zero and whether Choice and Interest differed from 0.5 or zero respectively. We considered statistical significance if p~mcmc~ < 0.05.  
 
#### Ethical note
Subjects were collected from a breeding colony that had been kept in the lab since 2019. All animals in this experiment were provided humane laboratory housing, thermoregulation opportunities, and light and humidity conditions (see above for details). Lizards in the colony received five to seven crickets per individual three times a week while the subjects in the experiment were fed once per day. All lizards were handled minimally to avoid stress. Experimental procedures and laboratory housing complied with Australian law and were approved by the Australian National University Animal Experimentation Ethics Committee (A2022_33). Upon completion of experimental trials, lizards were kept in their enclosure and will be euthanized following standard humane procedures once they reach the humane endpoint.  
 

## Results

```{r, data_process}
#| label: data_process
# Load the data and process it to get the main dfs
source(here("R", "data_process.R"))
```

```{r, models}
#| label: models
# Fitting the model and extraction of posteriors 
refit = FALSE
if(refit){
  # Get the formula and family of variables
  lat <- bf(log(latency) ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = gaussian())
  choice <- bf(choice ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = bernoulli(link = "logit"))
  int <- bf(compared_interest ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch),
    family = gaussian())
  # Fit the model
  model <- brm(lat + choice + int,
                chains = 4, cores = 4, iter = 4000, warmup = 1000, control = list(adapt_delta = 0.99, max_treedepth =12),
                data = data_num)
    # Write the model to a file
    saveRDS(model, file = here("output/models/model_num.rds"))
  } else {
      # Read the model from a file
      model <- readRDS(file = here("output/models/model_num.rds"))
  } 
# 
```

```{r, posteriors}
#| label: posteriors
# Code to extract posteriors from the model and get predicted values
source(here("R", "func.R"))
#
## Extract posteriors
posteriors <- as_draws_df(model)
# 
## Get predictions for every test and treatment based on the posteriors of the model. We used the function org_post (see func.R) to get the predictions.
#
# Latency
post_lat <- org_post("lat")
# Choice
post_choice <- org_post("choice")
prob_choice <- exp(post_choice)/(1 + exp(post_choice))
# Estimated interest for the higher amount of food
post_int <- org_post("int")
#
```

Latency was affected by sex (mean estimated effect of sex = `r {format_dec(mean(posteriors$b_loglatency_sexm), 2)}`, 95% CI = [`r {format_dec(quantile(posteriors$b_loglatency_sexm, 0.025), 2)}`, `r {format_dec(quantile(posteriors$b_loglatency_sexm, 0.975), 2)}`]) and age (mean estimated effect of age = `r {format_dec(mean(posteriors$b_loglatency_age),2)}`, 95% CI = [`r {format_dec(quantile(posteriors$b_loglatency_age, 0.025), 2)}`, `r {format_dec(quantile(posteriors$b_loglatency_age, 0.975),2)}`]; see Table S1 in Supplementary Material). Males and older individuals made, overall, faster decisions. However, we did not see such effects on Choice or Interest (see Table S1 in Supplementary Material). Nevertheless, when we analyse the effect of treatment on performance, for every variable recorded, we control for sex by averaging the predicted values for males and females, and we control for age by including the centered age in the model. These results are summarized in @fig-results and Table 1.  

```{r, fig-results}
#| label: fig-results
#| fig.cap: "Mean estimates of log-latency (Latency), the probability of choosing first the larger number of crickets (Choice), and the estimated interest for the larger number of crickets (Interest) per each of the treatments for each of the numerical tests performed. The x-axis represents the estimate, and the y-axis is the density of the estimates. The different colours indicate the different treatments. Points and bars represent the mean and standard deviation of the mean of the estimates, respectively. Vertical dashed lines in Choice and Interest graphs values 0.5 and 0, respectively."
#
source(here("R", "func.R"))
#
#### A) Organise the df used for both parts of the figure for each variable
#
# First the df for violin plots for each variable using df_violin_plot function from func.r
df_viol_lat <- df_violin_plot("lat")
df_viol_choice <- df_violin_plot("choice")
df_viol_int <- df_violin_plot("int")
#
# Second the df for the points and bars plot for each variable using df_bars_plot function from func.r
df_bars_lat <- df_bars_plot("lat")
df_bars_choice <- df_bars_plot("choice")
df_bars_int <- df_bars_plot("int")
#
#### B) Make the plots for each variable using plotting function from func.r
#
fig_lat <- plotting("lat")
fig_choice <- plotting("choice")
fig_int <- plotting("int")
#
#### C) Combine the plots and make final figure
fig_results <- plot_grid(fig_lat, fig_choice, fig_int, ncol = 1)
ggsave("./output/figures/fig_results.png", plot=fig_results, width = 25, height = 25, units = "cm", dpi = 600)
knitr::include_graphics("./output/figures/fig_results.png")
```

Neither temperature, CORT, nor their interaction contrasts affected performance in any of the tests, nor were there any clear patterns suggestive of an effect of the developmental environment on numerical discrimination (see Table 1 and @fig-results). Except for Hot-CORT lizards in 1 VS 3 tests or Cold-Control lizards in 2 VS 3 tests, the predicted probability of choosing the larger number of crickets first was not different from 0.5 (@fig-results; but also see Table S2 in Supplementary Material). Similarly, Interest was not different from 0 in any of the tests (@fig-results; but also see Table S2 in Supplementary Material).  

_Table 1. Effects of temperature, CORT, and their interaction on Latency, Choice, and Interest in each of the numerical discrimination tests. The table shows the contrasts for each predictor (Temperature = [meanHot - meanCold]; Hormone = [meanControl - meanCORT]; Interaction = [(meanHot-Control - meanHot-CORT) - (meanCold-Control - meanCold-CORT)]) and the p~mcmc~ value of the contrasts. In bold, the effects where p~mcmc~ < 0.05._
```{r, tbl-data}
#| label: tbl-data
#| tbl-cap: "Effects of temperature, CORT, and their interaction on Latency, Choice, and Interest in each of the numerical discrimination tests. The table shows the contrasts for each predictor (Temperature = [meanHot - meanCold]; Hormone = [meanControl - meanCORT]; Interaction = [(meanHot-Control - meanHot-CORT) - (meanCold-Control - meanCold-CORT)]) and the p~mcmcm~ value of the contrasts. In bold, the effects where p~mcmc~ < 0.05."
source(here("R", "func.R"))
#
# Making the df for each variable
#
## Initialize df_org as a list to store data frames for each variable
df_org <- list()
## Define variables and tests
variable <- c("Latency", "Choice", "Interest")
test <- c("1VS4", "1VS3", "2VS4", "2VS3", "3VS4")
## Loop over each variable
for(a in variable){
  # Select the original df to use depending on the variable
  if(a == "Latency"){
    post <- post_lat
  } else if(a == "Choice"){
    post <- prob_choice
  } else if(a == "Interest"){
    post <- post_int
  }
  df_tables <- data.frame()
  for(b in test){
    # Modify the df to get the values per each test
    post_mod <- post %>%
      dplyr::select(dplyr::matches(b))
    # Extract the required columns
    Cold_CORT <- post_mod[[paste0("X", b, "_Cold_CORT")]]
    Cold_Control <- post_mod[[paste0("X", b, "_Cold_Control")]]
    Hot_CORT <- post_mod[[paste0("X", b, "_Hot_CORT")]]
    Hot_Control <- post_mod[[paste0("X", b, "_Hot_Control")]]
    # Calculate effects and pmcmc values
    effect_temp <- format_dec(mean(c(Hot_CORT, Hot_Control)) - mean(c(Cold_CORT, Cold_Control)), 1)
    effect_hormone <- format_dec(mean(c(Hot_Control, Cold_Control)) - mean(c(Hot_CORT, Cold_CORT)), 1)
    interaction <- format_dec((mean(Hot_Control) - mean(Cold_Control)) - (mean(Hot_CORT) - mean(Cold_CORT)), 1)
    #
    pmcmc_temp <- format_p(pmcmc(c(Hot_CORT, Hot_Control) - c(Cold_CORT, Cold_Control)), 2)
    pmcmc_hormone <- format_p(pmcmc(c(Hot_Control, Cold_Control) - c(Hot_CORT, Cold_CORT)), 2)
    pmcmc_interaction <- format_p(pmcmc((Hot_Control - Cold_Control) - (Hot_CORT - Cold_CORT)), 2)
    # Define labels and values
    effects_predictors_names <- c("Temperature", 
                          "Hormone", 
                          "Interaction")
    values_predictors <- c(effect_temp, effect_hormone, interaction)
    values_pmcmc <- c(pmcmc_temp, pmcmc_hormone, pmcmc_interaction)
    # Create a temporary data frame for this loop iteration
    temporal_df <- data.frame(Predictor = effects_predictors_names,
                        Effect = values_predictors,
                        pmcmc = values_pmcmc,
                        Test = b,
                        stringsAsFactors = FALSE)
    # Merge the temporary data frame to the main df_tables
    df_tables <- rbind(df_tables, temporal_df)
  }
  df_tables$Variable <- a
  df_org[[a]] <- df_tables
}
# Combine all data frames in df_org into one data frame
table_df <- do.call(rbind, df_org)
# Convert the combined list into a data frame and modify for the table
table_df <- as.data.frame(table_df, stringsAsFactors = FALSE) %>%
  mutate(results = trimws(paste0(Effect, " (p", pmcmc,")"))) %>%
  dplyr::select(Variable, Test, Predictor, results) %>%
  pivot_wider(names_from = Test, values_from = c(results), names_prefix = "")
#
#
# Making the table
#
## Table format
set_flextable_defaults(
 font.family = "Arial",
 font.size = 9)
# Create the table
real_table <- flextable(table_df) %>%
    align(align="center", part="all") %>% 
    add_header_row(values = c("", "Tests"), colwidths = c(2, 5)) %>%
    flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
    hline(i = c(3,6), j = c(1:7), part = "body") %>% # To make some horizontal lines 
    set_table_properties(layout = "autofit", width = 1)
real_table
```


## Discussion
Our results indicate that lizards did not discriminate between different numbers of crickets and that their performance did not vary across treatments. We predicted that lizards would employ nummerical cues to make foraging decisions, and that their ability to discriminate between those cues would be impaired with exposure to CORT during development or cold incubation temperatures. Our findings suggest otherwise. We did not see changes in Latency in any of the tests, and treatment did not affect lizards' time to make a decision either. Furthermore, in most cases, Choice did not differ from random (0.5), with significant differences emerging only in two tests for two of the four treatments; yet no clear pattern was observed. These findings were further reinforced by similar results regarding Interest, that did not differ from zero in any of the tests or treatments. Altogether, these findings suggest that _L. guichenoti_ did not use numerical or other potential quantitative cues we were not controlling for to make foraging decisions.  

Our experiment employed a spontaneous choice test to investigate _L. guichenoti_'s numerical abilities. This test is considered a reliable method to animal numerosity, as it allows for observing instictive behaviours [@nieder2005counting; @agrillo2014spontaneous]. However, one of the main caveats of this approach is that motivation plays a key role in animals' performance [@agrillo2014spontaneous; @bisazza2014experim]. Here, we discarded the trials in which the lizards did not interact with any of the options, so the observed results are based exclusively on those trials in which a choice was made. Therefore, we do not consider motivation a factor affecting our results. 

Another consideration is the limitation of spontaneous choice tests to control for other quantitative cues that may correlate with numerosity [@agrillo2014spontaneous]. Although we controlled for some quantitative information by rotating crickets in the option with fewer items to increase total area, we can not rule out the possibility that lizards could use other quantitative cues. If that were the case, however, we would still see some type of discrimination between choices unless the cues were conflicting [@cooper2024tell]. Indeed, it is possible that _L. guichenoti_ uses multiple quantitative cues simultaneously during foraging decisions. When those cues conflict, the preference for one cue over another might vary between individuals, potentially producing the results observed here. Alternatively, _L. guichenoti_ may not rely on numerical cues for foraging decisions, instead utilising other types of information.  

Spontaneous choice tests assume that animals should select the most appropriate quantity, which may not necessarily be the largest one [@agrillo2014spontaneous]. This occurrs if the costs of selecting the larger option outweigh the benefits. For example, when presented two groups with different numbers of conspecifics or if prey handling costs are related to larger quantitative traits like size [@agrillo2014spontaneous]. It could be that the perceived handling costs of larger number of crickets is affecting lizards' behaviour in our experiment. Nevertheless, in that scenario, we would still expect animals to exhibit a preference, even if for the smaller amount of food, or to observe some influence of age on Choice or Interest, as older animals are typically larger and may be more adept at handling a greater number of prey items. The absence of choice in most of the tests suggests that the benefits of selecting larger number of crickets are not different from selecting fewer. For instance, when considering hunting groups of 1 VS 4 or 2 VS 4 crickets, the probability of success might be similar. As a result, _L. guichenoti_ might not have evolved a preference for prey groups with such small differences. 

Interestingly, in those studies where reptiles discriminated between different amounts of food, the relevant stimuli involved either vegetables [@gazzola2018continuous; @szabo_spontaneous_2021] or large quantities (e.g., 5 vs. 10)[@recio_prey_2021]. In contrast, when _Podarcis siculus_ were presented different numbers of _Musca domestica_ larvae in a spontaneous choice test, the lizards failed to discriminate between quantities despite showing high quantitative skills when prey size was the main cue [@miletto2017quantitative] or when tested using training procedures [@miletto2018quantity]. Further studies on numerosity in _L. guichenoti_ should explore different methods, stimuli or contexts. For example, using larger quantities [@nieder2005counting; @recio_prey_2021], testing numerical discrimination in the context of mate selection [@carazo2009quantity; @lucon2017individual], or employing training procedures [@agrillo2014spontaneous; @bisazza2014experim; @soldati2017long; @miletto2018quantity; @lin2021superior; @tomonaga2023slowly; @lin2024trained] may yield more conclusive results.  

We did not find any effect of prenatal conditions on _L. guichenoti_'s ability to use numerical information to make foraging decisions. We anticipated that lower incubation temperatures and exposure to CORT will impair lizards' performance, especially in those tests with higher ratios following Weber's Law [@agrillo2014spontaneous; @nieder2018evolution]. However, our treatments did not impact lizards' behaviour. Our predictions were based on previous studies showing the effects of prenatal temperature and GCs on cognitive abilities in reptiles and other groups [@szuran_water_1994; @zhu_prenatal_2004; @amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @lui2017chronic]. However, these effects can be species-specific, varying across cognitive domains and test types [@szuran_water_1994; @farrell_developmental_2015-learn; @bebus_associative_2016;@dayananda_incubation_2017; @abayarathna_effects_2020; @haq_prenatal_2021]. 

In this context, it is important to consider that both GCs and thermal environment can exert differential effects on distinct regions of the brain. For example, incubation temperature impacts mitochondrial activity and cell density in specific brain nuclei [@coomber_independent_1997; @amiel_effects_2017]. Similarly, impairments in spatial learning - but not in other learning tasks - in rats [@haq_prenatal_2021] are likely associated with the greater density of GCs receptors in mammals' hippocampus compared to other regions of the brain [@siegel_2006]. Researchers have proposed that non-verbal number representation is processed by two types of systems: one for small sets (≤ 4) that tracks and encodes objects as individual entities, and another for larger numerosities that operate through estimation processes [@nieder2005counting; @cantlon2009beyond; @hyde2011two]. While it remains unknown which areas of the reptiles' brain encode numerical information, our results suggest that those brain regions involved in discrete numerical representation might be robust to the effect of prenatal CORT and temperature in _L. guichenoti_. Alternatively, it is also plausible that treatment effects are masked by the overall poor performance across most of the tests, which could be a consequence of the species’ reliance on another type of cues for foraging other than numerical information. Thus, future research should investigate the effects of prenatal CORT and thermal environment on numerical competence by employing trained quantity discrimination tasks and higher quantities [@soldati2017long; @miletto2018quantity; @lin2021superior; @tomonaga2023slowly; @lin2024trained].  

Our study is, to the best of our knowledge, the first to explore the impact of prenatal conditions on numerical abilities in reptiles. Our findings suggest that _L. guichenoti_ does not rely on numerical information for foraging decisions and that their performance does not vary across different prenatal treatments. These results indicate that early environmental conditions, such as incubation temperature and CORT exposure, may not affect numerosity in this species. However, it is critical to note that the methodologies employed in this study may not have fully captured the nuances of numerical cognition in _L. guichenoti_. Therefore, we recommend that future studies employ a broader array of tests and paradigms, including training-based tasks, larger sets of stimuli, and other sensory modalities, to more comprehensively assess numerical competence in this and related species. Such work will be fundamental in unravelling early environmental factors' effects on reptiles' cognitive abilities and advancing our understanding of numerical discrimination across taxa.  

## Data accessibility  
All data, data description, and R code are available in public repository [https://github.com/Pablo-Recio/CORT-Temp_Numerical](https://github.com/Pablo-Recio/CORT-Temp_Numerical).  

## Declaration of AI use  
We declare Chat GPT was used for questions related to coding and data analyses. All other parts of the manuscript were written by the authors and those parts where AI was used were checked and modified accordingly by the authors.  

## Authors' contributions  
PR: conceptualization, methodology, data collection, data curation, formal analysis, writing—original draft, writing—review and editing; DL: data collection, writing—review and editing; OC: conceptualization, writing—review and editing; CF: conceptualization, funding acquisition, writing—review and editing; AP: data collection, writing—review and editing; DN: conceptualization, methodology, funding acquisition, project administration, resources, supervision, writing—review and editing.  
All authors gave final approval for publication and agreed to be held accountable for the work performed therein.  

## Conflict of interest declaration  
We declare we have no competing interests.  

## Funding  
This work was supported by a National Australian University fellowship (PR), and the Australian Research Council (grant no. DP210101152) to DN and CF.  

## Acknowledgements  
We thank the help and assistance of our lab technicians Benjamin Durant and Michelle Stephens for taking care of the lizards. We are also grateful ANU MakerSpace, where we designed and built the prototypes of the 3D-printed platforms. Finally, we wish to acknowledge the anonymous reviewers for their valuable feedback on the manuscript.  

## References
<div id="refs"></div>

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

# Suplementary Material

#### Model results

_Table S1.- Summary of the model fitted_

```{r, summary_org}
#| label: summary_org
#
## Get the summary of the posteriors to get the estimates of each parameter of the model
sum <- summary(posteriors)
## Extract the values of the summary
sum_2 <- as.data.frame(sum) %>%
  dplyr::select(-mad) %>%
  filter(!str_detect(variable, "^r_"))
sum_df <- sum_2 %>%
  mutate(across(where(is.numeric), ~ sprintf(paste0("%.", 2, "f"), .)))  
```


For loglatency (Latency)
```{r, tbl-summary_lat}
#| label: tbl-summary_lat
#| tbl-cap: "Summary of the model fitted for the latency variable."
#
source(here("R", "func.R"))
## Get df only for latency
df_sum_lat <- sum_table_org(sum_df, "lat")
## Make table
table_sum_lat <- flextable(df_sum_lat)
table_sum_lat
```


For Choice
```{r, tbl-summary_choice}
#| label: tbl-summary_choice
#| tbl-cap: "Summary of the model fitted for the choice variable."
#
source(here("R", "func.R"))
## Get df only for choice
df_sum_choice <- sum_table_org(sum_df, "choice")
## Make table
table_sum_choice <- flextable(df_sum_choice)
table_sum_choice
```


For Interest
```{r, tbl-summary_int}
#| label: tbl-summary_int
#| tbl-cap: "Summary of the model fitted for the interest variable."
#
source(here("R", "func.R"))
## Get df only for interest
df_sum_int <- sum_table_org(sum_df, "int")
## Make table
table_sum_int <- flextable(df_sum_int)
table_sum_int
```


Other effects
```{r, tbl-summary_other}
#| label: tbl-summary_other
#| tbl-cap: "Summary of the model fitted for other effects."
#
source(here("R", "func.R"))
## Get df only for interest
df_sum_other <- sum_df %>%
  filter(!str_detect(variable, "^b_"))
## Make table
table_sum_other <- flextable(df_sum_other)
table_sum_other
```


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Treatments effects

_Table S2.- Estimated mean probability of choosing first the higher amount (Choice) and the mean interest for the higher amount of food (Interest) per treatment group for each of the numerical tests performed. p indicates the p~mcmcm~ value (p) of testing the hypothesis Choice ≠ 0.5, and Interest ≠ 0, which would indicate a preference towards one of choices (> towards higher amounts, < towards lower amounts) of the contrasts. In bold, the groups where p~mcmcm~ < 0.05_
```{r, tbl-disc}
#| label: tbl-disc
#| tbl-cap: "Estimated probability of choosing first the higher amount (Choice) and the interest for the higher amount of food (Interest) per treatment group for each os the tests performed. p indicates the p~mcmcm~ value of testing the hypothesis Choice ≠ 0.5, and Interest ≠ 0, which would indicate a preference towards one of choices (> towards higher amounts, < towards lower amounts) of the contrasts."
#
source(here("R", "func.R"))
#
# Making the df for each variable
#
## Initialize df_org as a list to store data frames for each variable
disc_list <- list()
## Define variables and tests
variable <- c("Choice", "Interest")
test <- c("1VS4", "1VS3", "2VS4", "2VS3", "3VS4")
## Loop over each variable
for(c in variable){
  # Select the original df to use depending on the variable
  if(c == "Choice"){
    post <- prob_choice
    val <- 0.5
  } else if(c == "Interest"){
    post <- post_int
    val <- 0
  }
  df_disc <- data.frame()
  for(d in test){
    # Modify the df to get the values per each test
    post_mod <- post %>%
      dplyr::select(dplyr::matches(d))
    # Extract the required columns
    Cold_CORT <- post_mod[[paste0("X", d, "_Cold_CORT")]]
    Cold_Control <- post_mod[[paste0("X", d, "_Cold_Control")]]
    Hot_CORT <- post_mod[[paste0("X", d, "_Hot_CORT")]]
    Hot_Control <- post_mod[[paste0("X", d, "_Hot_Control")]]
    # Calculate means and pmcmc values
    Cold_CORT_mean <- format_dec(mean(Cold_CORT), 2)
    Cold_Control_mean <- format_dec(mean(Cold_Control), 2)
    Hot_CORT_mean <- format_dec(mean(Hot_CORT), 2)
    Hot_Control_mean <- format_dec(mean(Hot_Control), 2)
    #
    pmcmc_Cold_CORT <- format_p(pmcmc(Cold_CORT, null = val), 2)
    pmcmc_Cold_Control <- format_p(pmcmc(Cold_Control, null = val), 2)
    pmcmc_Hot_CORT <- format_p(pmcmc(Hot_CORT, null = val), 2)
    pmcmc_Hot_Control <- format_p(pmcmc(Hot_Control, null = val), 2)
    # Define labels and values
    treatment_names <- c("Cold-CORT", "Cold-Control", "Hot-CORT", "Hot-Control")
    values_means <- c(Cold_CORT_mean, Cold_Control_mean, Hot_CORT_mean, Hot_Control_mean)
    values_pmcmc <- c(pmcmc_Cold_CORT, pmcmc_Cold_Control, pmcmc_Hot_CORT, pmcmc_Hot_Control)
    # Create a temporary data frame for this loop iteration
    temporal_df <- data.frame(Treatment = treatment_names,
                        Effect = values_means,
                        pmcmc = values_pmcmc,
                        Test = d,
                        stringsAsFactors = FALSE)
    # Merge the temporary data frame to the main df_tables
    df_disc <- rbind(df_disc, temporal_df)
  }
  df_disc$Variable <- c
  disc_list[[c]] <- df_disc
}
# Combine all data frames in df_org into one data frame
disc_df <- do.call(rbind, disc_list)
# Convert the combined list into a data frame and modify for the table
disc_df_final <- as.data.frame(disc_df, stringsAsFactors = FALSE) %>%
  mutate(pmcmc = gsub("^= ", "", pmcmc)) %>%
  pivot_wider(names_from = Variable, values_from = c(Effect, pmcmc), names_prefix = "") %>%
  dplyr::select(Test, Treatment, 
                Effect_Choice, pmcmc_Choice,
                Effect_Interest, pmcmc_Interest)
#
#
# Making the table
#
## Table format
set_flextable_defaults(
 font.family = "Arial",
 fint.size = 10)
# Create the table
disc_table <- flextable(disc_df_final) %>%
    set_table_properties(width = 1) %>%
    align(align="center", part="all") %>% 
    # Bold the cell containing "< 0.05" in the `pmcmc_Choice` column and the next cell
    bold(i = which(disc_df_final$pmcmc_Choice == "< 0.05"), j = "pmcmc_Choice", part = "body") %>%
    bold(i = which(disc_df_final$pmcmc_Choice == "< 0.05"), j = "Effect_Choice", part = "body") %>%
    bold(i = which(disc_df_final$pmcmc_Choice == "< 0.05"), j = "Treatment", part = "body") %>%
    # Bold the cell containing "< 0.05" in the `pmcmc_Interest` column and the next cell
    bold(i = which(disc_df_final$pmcmc_Interest == "< 0.05"), j = "pmcmc_Interest", part = "body") %>%
    bold(i = which(disc_df_final$pmcmc_Interest == "< 0.05"), j = "Effect_Interest", part = "body") %>%
    bold(i = which(disc_df_final$pmcmc_Interest == "< 0.05"), j = "Treatment", part = "body") %>%
    flextable::compose(i = c(2:4,6:8,10:12,14:16,18:20), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
    flextable::compose(i = 1, j = c(3,5), value = as_paragraph("Est. mean"), part = "head") %>% 
    flextable::compose(i = 1, j = c(4,6), value = as_paragraph("p"), part = "head") %>% 
    hline(i = c(4,8,12,16), j = c(1:6), part = "body") %>% # To make some horizontal lines
    vline(i = c(1:20), j = 4, part = "body") %>% # To make some vertical lines
    vline(i = 1, j = 4, part = "head") 
disc_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Testing potential side biases

_Table S3.- Number of individuals per treatment that chose the right (R) or left (L) side in each of the numerical tests. p-value indicates the result of the binomial test comparing the number of choices between sides. In bold, the groups where p-value < 0.05_
```{r, tbl-sides}
#| label: tbl-sides
#| tbl-cap: "Number of individuals per treatment that chose the right (R) or left (L) side in each of the numerical tests. p-value indicates the result of the binomial test comparing the number of choices between sides."
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_sides <- data_num %>%
  group_by(trt, test_type) %>% # Group by treatment and test
  summarise(
    right_choices = sum(side_choice == "Right", na.rm = TRUE),
    left_choices = sum(side_choice == "Left", na.rm = TRUE),
  ) %>% # Count the number of correct choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = right_choices + left_choices,  # Calculate total choices
    p_value = format_dec(binom.test(right_choices, total_choices)$p.value, 2)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(choices_Right_Left_p = paste0("R = ", right_choices, " | L = ", left_choices, " , p = ", p_value), # Create a column with the choices
        trt = recode(trt, 
                 "B_23" = "CORT-Cold (n = 20)", 
                 "A_23" = "Control-Cold (n = 20)", 
                 "B_28" = "CORT-Hot (n = 20)", 
                 "A_28" = "Control-Hot (n = 20)")) %>% # To order the treatments
  dplyr::select(trt, test_type, choices_Right_Left_p) %>% # Remove unused columns
  pivot_wider(names_from = test_type, values_from = c(choices_Right_Left_p)) %>% # To split between tests
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
sides_table <- flextable(data_sides) %>%
  compose(j = 1, value = as_paragraph(""), part = "header") %>%
  compose(j = 2, value = as_paragraph("1 VS 4"), part = "header") %>%
  compose(j = 3, value = as_paragraph("1 VS 3"), part = "header") %>%
  compose(j = 4, value = as_paragraph("2 VS 4"), part = "header") %>%
  compose(j = 5, value = as_paragraph("2 VS 3"), part = "header") %>%
  compose(j = 6, value = as_paragraph("3 VS 4"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
sides_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Prey orientation test
Because we were concerned that the orientation of the crickets could affect the lizards' choice, we performed one simple choice test to investigate this. We used the same platform and Petri dish as in the numerical discrimination task, but we placed one cricket on each side of the platform, one oriented vertically in respect to the shelter position (see @fig-Methods B) and the other one horizontal to the shelter. We performed a unique trial randomising the position of the orientation of the cricket. We recorded the number of individuals that chose the cricket oriented vertically and horizontally. Results are shown in the table below.

_Table S4. Number of individuals per treatment that chose the cricket oriented horizontally (Horizontal) or vertically (Vertical) in our control tests. p-value indicates the result of the binomial test comparing the number of choices between both choices._
```{r, tbl-orientation}
#| label: tbl-orientation
#| tbl-cap: "Number of individuals per treatment that chose the cricket oriented horizontally (Horizontal) or vertically (Vertical) in our control tests. p-value indicates the result of the binomial test comparing the number of choices between both choices."
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_or_res <- data_orient %>%
  mutate(choice_or = ifelse(choice_horizontal == 0, "Vertical", "Horizontal")) %>%
  dplyr::select(trt, choice_horizontal, choice_or) %>%
  group_by(trt) %>% # Group by treatment and test
  summarize(
    Horizontal_Count = sum(choice_or == "Horizontal"),
    Vertical_Count = sum(choice_or == "Vertical")
  ) %>% # Count the number of horizontal and vertical choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = Horizontal_Count + Vertical_Count,  # Calculate total choices
    p_value = format_dec(binom.test(Horizontal_Count, total_choices)$p.value, 3)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(trt = recode(trt, 
            "B_23" = "CORT-Cold (n = 20)", 
            "A_23" = "Control-Cold (n = 20)", 
            "B_28" = "CORT-Hot (n = 20)", 
            "A_28" = "Control-Hot (n = 20)")) %>% # To order the treatments
  dplyr::select(trt, Horizontal_Count, Vertical_Count, p_value) %>% # Remove unused columns
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
orient_table <- flextable(data_or_res) %>%
  compose(j = 1, value = as_paragraph(""), part = "header") %>%
  compose(j = 2, value = as_paragraph("Horizontal"), part = "header") %>%
  compose(j = 3, value = as_paragraph("Vertical"), part = "header") %>%
  compose(j = 4, value = as_paragraph("p-value"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
orient_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Checking the model plots  
```{r, checking_model, out.width="70%", fig.align="center"}
# Chunk for plotting the model
## Initial plot
plot(model)
#
## pp_checks
pp_check(model, resp = "loglatency")
pp_check(model, resp = "choice")
pp_check(model, resp = "comparedinterest")
```
