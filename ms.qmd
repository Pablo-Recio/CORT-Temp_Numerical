---
title: "Do early environmental experiences impact numerical discrimination abilities in a lizard?"
docx: 
  reference-doc: "./bib/tmpl.docx"
bibliography: "./bib/refs.bib"
csl: "./bib/behavioral-ecology-and-sociobiology.csl"
execute:
  echo: false
  error: false
  cache: false
  warning: false
link-citations: true
crossref:  
  fig-title: Fig    # (default is "Figure")
  title-delim: —     # (default is ":")
  fig-prefix: Fig.   # (default is "Figure")
  tbl-prefix: Table  # (default is "Table")
editor_options: 
  chunk_output_type: console
---

```{r, packages}
#| label: packages
pacman::p_load(tidyverse, flextable, emmeans, DHARMa, brms, here, ggplot2, lme4, zoo, lmerTest, broom, tidybayes, forcats, MASS, nortest, fitdistrplus, ggh4x, PupillometryR, cowplot, png, grid, remotes, ggthemes, bayestestR, HDInterval)
```

Pablo Recio^1^,$\ddagger$ , Dalton C. Leibold^1^, Ondi L. Crino ^1,2^, Christopher R. Friesen^3^, Amelia Y. Peardon ^1^, Daniel W.A. Noble^1^

^1^ Division of Ecology and Evolution, Research School of Biology, The Australian National University, Canberra, ACT 2601, Australia  
^2^ Flinder's University, College of Science and Engineering, Bedford Park, SA 5042, Australia  
^3^ University of Wollongong, Wollongong, NSW 2500, Australia  
$\ddagger$ Corresponding author: pablo.reciosantiago@anu.edu.au  

ORCID:

Pablo Recio ORCID: 0000-0002-5890-0218  
Dalton C. Leibold ORCID: 0000-0001-9645-2033  
Ondi L. Crino ORCID: 0000-0001-5700-1387  
Christopher R. Friesen ORCID: 0000-0001-5338-7454  
Amelia Y. Peardon ORCID: 0009-0005-6227-8379  
Daniel W.A. Noble ORCID: 0000-0001-9460-8743

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

## Keywords
Numerical discrimination, Corticosterone, Temperature, Reptiles, Early life stress, Cognitive abilities 

## Abstract

**From social behaviour to navigating complex environments, quantitative abilities can be crucial to fitness. However, early life conditions can impact brain development to affect quantitative competence. For example, early thermal conditions or glucocorticoid concentrations (GCs) – stress-related hormones transmitted by the parents – can play a prominent role in shaping cognition through their effects on brain physiology. Furthermore, temperature can lead to increased levels of GCs that can be transmitted to offspring, emphasizing the need to study the combined effects of these two factors. Here, we investigated the effects of elevated prenatal corticosterone (CORT) – the main GC in reptiles – and incubation temperature on numerical discrimination in the common garden skink (_Lampropholis guichenoti_). We assessed numerical abilities through a spontaneous choice test with food as a stimulus. Employing a repeated measures design, we subjected lizards to five numerical tests each differing in the ratios between the two choices (1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4). Contrary to our predictions, we found no evidence for treatment effects on lizard behaviour and no use of numerical discrimination during foraging in _L. guichenoti_. Our findings build on previous studies suggesting that reptiles feeding on live prey may have difficulty distinguishing between different prey quantities. Despite our results, further investigation of numerical abilities in live-prey-feeding reptiles and the impact of early conditions on other taxa is warranted, as these areas remain understudied.**       


## Significance statement

**Discriminating between quantities can be crucial for individual fitness, yet the impact of early environmental factors on the development of quantitative competence remains largely unexplored. In this study, we investigated, for the first time, the effects of prenatal corticosterone exposure and incubation temperature on numerical discrimination in a reptile. Contrary to our predictions, we did not observe any evidence of numerical discrimination and therefore no impact of early developmental environment. Our results align with previous studies showing that reptiles consuming live prey struggle to differentiate prey numbers in spontaneous choice tests. These results open new avenues for exploring the evolution of numerical abilities in reptiles and identifying factors influencing the development of quantitative skills in this group. Further research should explore alternative methods, such as trained tasks, to better understand the cognitive mechanisms underlying quantitative competence in reptiles.**  

## Introduction  
The ability to discriminate between quantities is a fundamental cognitive skill widely observed across the animal kingdom [@stancher2015numerical; @vonk2012bears; @beran2016capuchin]. Numerical cognition can contribute to social decisions, mate selection, and foraging behaviour, which can be adaptive in various ecological contexts [@lucon2017individual; @nieder2018evolution]. For instance, female lions (_Panthera leo_) use numerical information to assess the risk of confronting rival groups [@mccomb1994roaring], male adult mealworms (_Tenebrio molitor_) select sites with scents of more females [@carazo2009quantity], and red-backed salamanders (_Plethodon cinereus_) prefer tubes containing larger numbers of prey [@uller2003salamanders]. Given the adaptive advantages of numerical and quantity discrimination, research has focused extensively on exploring the ability of different species to differentiate between quantities employing different contexts and paradigms.  

The main two approaches experimental approaches in the study of quantity discrimination are spontaneous choice tests and training procedures. In spontaneous choice tests, the subjects are presented two groups of biologically relevant stimuli differing in some quantitative trait (number, size, volumen, etc) and the experimenters record if the subjects select or not the most most appropriate quantity (e.g. the group with more conspecifics or the larger amount of food) (@agrillo2014spontaneous; @cox2016quantity). In training procedures, animals must learn a numerical rule to receive a reward [@agrillo2014spontaneous; @miletto2018quantity]. Both methods are believed to be complementary to each other, and both can provide different results even in the same species [see @miletto2017quantitative and @miletto2018quantity]. One reason is that spontaneous choice tests assume that one of the options presented is more adequate than the other when this may not always be the case. For example, choosing groups of conspecifics with less individuals could be advantageous when food is scarce but disadvantageous when predators are abundant [**REFs first thesis??**]. As such, context and motivation can be important drivers of decision-making that can change the way we measure animals' abilities to discriminate between quantities [@agrillo2014spontaneous]. The other reason is that each method may tap into different cognitive mechanisms [@agrillo2014spontaneous]. In this sense, **Researchers have suggested that numerousness can be processed by two types of systems: one system for small sets (≤ 4) that works by tracking and encoding objects as individual entities; and an analogous system that operates with large numerosities by estimation processes (for a review, see Cantlon et al. (2009); Hyde (2011).**   **HOW CAN EACH BE RELATED TO MOTIVATION OR LEARNING??**

**Differences in test discrete (OFS) versus overall quantity/size (ANS). How to measure both? Creating NUMBER inconsistencies with the SAME SIZE (examples).** OFS, can be challenging, since it is necessary to control for other continuous variables such as area, density, or movement (@agrillo2014spontaneous; **Mehlis et al. 2015**). Generally, authors increase one variable at a time without increases in the other to give conflicting information about the correlation between numerical cues and quantitative continuous traits [**REFs**]. For example, **Look for something where they increase number controlling for size** **HOW??** 

No other amphibian or non-avian reptile study has set out to
manipulate these variables to a degree as thoroughly as Stancher et al.42. Future experiments
involving amphibians and non-avian reptiles that manipulate these variables will be crucial for
understanding the relationship between the core systems and the information available for
discrimination


These studies have been traditionally focused on mammals, birds, and fishes despite the influence of numerical cognition on fitness across taxa [@nieder2005counting; @agrillo2014spontaneous]. However, recent studies demonstrate that other vertebrates like amphibians or non-avian reptiles are also competent in numbers [@uller2003salamanders; @stancher2015numerical; @miletto2017quantitative]. For example, red-footed turtles (_Chelonoidis carbonaria_) rapidly learned to associate colour with higher volumes of food [@soldati2017long], Hermann’s tortoises (_Testudo hermanni_) discriminate between large and small food quantities in a spontaneous choice test [@gazzola2018continuous], and freshwater turtles (_Trachemys scripta_ and _Mauremys sinensis_) rapidly learned a quantity discrimination task [@lin2021superior; @lin2024trained]. The Italian wall lizard (_Podarcis siculus_) failed to discriminate between different numbers of food items in a spontaneous choice test [@miletto2017quantitative], but succeeded in a trained quantity discrimination task [@miletto2018quantity]. In contrast, Iberian rock lizards (_Iberolacerta cyreni_) spontaneously preferred larger quantities of crickets when presented five versus ten items [@recio_prey_2021]. **In skinks,** 

Lizards were presented with food quantities
differing in number or size and were able to select the larger quantity of food items when they differed in number but not when items
differed in size. We show, for the first time, superior spontaneous discrimination of items differing in number over size in a lizard spe-
cies, which contrasts with previous findings. Our simple method, however, did not include controls for the use of continuous quantities,
and further tests are required to determine the role of such information during quantity discrimination. [@szabo_spontaneous_2021]

We subjected lizards to a Y-maze experiment presenting both discrete (comparisons involving two
vs. four, two vs. six, two vs. eight, four vs. six, four vs. eight, and six vs. eight pieces) and equivalent continuous combinations (single
pieces differing in size) of pumpkin pieces. Our findings revealed that sleepy lizards exhibited spontaneous quantity discrimination, fa-
voring the larger quantity in three discrete comparisons (eight vs. two, two vs. six, four vs. six) and two continuous comparisons (eight
vs. two, eight vs. four). However, low accuracy may be attributable to difficulty in visual acuity exacerbated by difficulty discriminating
quantities at small ratios. [@szabo2024spontaneous]

**These studies demonstrate that reptiles have cognitive abilities related to quantity discrimination that have been overlooked in the past, but that should be explored further.**


Cognitive abilities, however, can be strongly influenced by developmental conditions when the brain is particularly sensitive to environmental inputs [@zhu_prenatal_2004]. For instance, the temperature at which embryos develop can affect neuron density or learning abilities in different species of reptiles [@amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @dayananda_incubation_2017; @siviter_incubation_2017; @abayarathna_effects_2020]. These thermal effects on cognition may arise directly or indirectly through impacts on parental condition [@Crino_2023]. Temperatures outside the optimal range can trigger stress responses, leading to the release of glucocorticoids (GCs) [@sapolsky_how_2000], which may then be transmitted to the offspring [@Crino_2023]. Elevated prenatal GCs can, in turn, influence cognition by altering brain function [@szuran_water_1994; @zhu_prenatal_2004; @crino_corticosterone_2014-learn; @farrell_developmental_2015-learn; @bebus_associative_2016; @lui2017chronic]. As such, the interaction between GCs and develpomental temperature must be relevant in shaping reptiles' cognition. Most studies on the effects of GC exposure or elevated temperatures during development focused on learning and memory, but few studies have investigated how early-life conditions can affect quantitative abilities despite the importance of numerical discrimination [but see @vila_pouca_quantity_2019]. Furthermore, the interactive effects of prenatal GCs and temperature on cognitive abilities remain largely unexplored.    
   
Here, we investigated the use of numerical cues in the common garden skink (_Lampropholis guichenoti_) using a spontaneous choice test where lizards were presented with different number of food items while **controlling** for total length. In adition, we examined how prenatal corticosterone (CORT) - the main GC in reptiles - and incubation temperature can affect numerical discrimination and decision-making in foraging contexts. To do so, we manipulated CORT concentration (CORT-treated or a sham control) in _L. guichenoti_ eggs and incubated them under one of two temperature regimes (Cold - 23 ± 3ºC or Hot - 28 ± 3ºC) in a 2x2 factorial design. Then, we assessed numerical discrimination abilities on five tests that differed in the relative number of food items: 1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4 crickets.  Previous studies in other skinks showed that these species can discriminater between different quantities of food, although the cues employed to do so remain unclear [@szabo_spontaneous_2021; @szabo2024spontaneous]. We predicted _L. guichenoti_ to be able to discriminate between different number of crickets even when controlling by total length. Furthermore, we predicted lizards' decisions to be influenced by the early conditions they were subjected to. In this regard, we hypothesized that lizards incubated at higher temperatures would outperform those incubated at lower temperatures in the numerical discrimination task [@amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @vila_pouca_quantity_2019]. We predicted that increased CORT levels would impair numerical competence [@szuran_water_1994; @zhu_prenatal_2004], with more pronounced effects at lower temperatures. Consistent with Weber's law, we predicted that lizards incubated at higher temperatures would successfully discriminate between quantities even at high ratios (e.g. 3 VS 4), whereas even the lowest ratios (e.g. 1 VS 4) could be challenging for those exposed to CORT or incubated at lower temperatures. 

## Methods  

#### Animal husbandry  
*Breeding colony* -- The lizards tested in our experiment came from a breeding colony established in the lab in 2019. The colony consisted of approximately 180 adults of _L. guichenoti_ housed in communal containers (41.5 L x 30.5 W x 21 H cm) with six lizards (2 males and 4 females) per enclosure. Enclosures were provided with non-stick matting, shelter, and several small water dishes filled daily, and lizards were fed mid-size crickets (*Acheta domestica*) three days a week. Crickets were dusted with calcium weekly and multivitamins and calcium biweekly. Room temperatures were set to 22-24ºC, but to ensure a temperature gradient, we employed a heat chord and a heat lamp following a 12 h light:12 h dark cycle, keeping the warm side of enclosures at 32-34ºC.  

*Egg collection and incubation* -- Between mid-October 2023 to the end of February 2024, we placed small boxes (12.5 L x 8.3 W x 5 H cm) containing vermiculite on one side of the communal enclosures (see above) to provide females with a place to lay the eggs. We checked for eggs in the boxes three days a week. Egg length and width were measured with a digital calliper to the nearest mm (± 0.1 mm), while mass was recorded with a digital scale (OHAUS, Model spx123) to the nearest g (± 0.001 g). Eggs were assigned a clutch number and an individual identity. Then we treated eggs with CORT or a vehicle control (see _Manipulating Early Thermal and CORT Environments_ details below) and placed them in individual cups (80 mL) with moist vermiculite (12 g water to 4 g vermiculite). We covered the cups with plastic wrap to retain moisture and left the eggs in incubators (LATWIT 2X5D-R1160) programmed to two different thermal regimes (see _Manipulating Early Thermal and CORT Environments_ details below) until hatching. Incubators were checked for the presence of hatchlings three times a week.  

*Hatchlings* -- Immediately after hatching, we measured Snout-Vent Length (SVL) and Tail Length (TL) with a ruler to the nearest mm (± 0.1 mm), and mass using a digital scale (OHAUS, Model spx123) to the nearest g (± 0.001 g). Hatchlings were then placed in individual enclosures (18.7L x 13.2W x 6.3H cm) provided with non-stick matting and a small water dish. During this period, they were given water daily and received 3-6 small *A. domestica* crickets three times a week. All care otherwise follows similar protocols to adults (see above).  


#### Manipulating Early Thermal and CORT Environments  

We manipulated CORT concentration in eggs and incubated them under one of two temperature regimes (Cold - 23 ± 3 ºC or Hot - 28 ± 3 ºC) in a 2x2 factorial design (@fig-Methods A). Eggs were allocated to one of two different developmental stress treatments: CORT-treated eggs were topically supplied with 5 µL of a CORT solution (10 pg/mL). Control treatment eggs received an equal volume of 100% Ethanol. Corticosterone treatments were made by dissolving crystalline corticosterone (Sigma, Cat. No. C2505) in 100% ethanol. We selected doses based on previous studies where CORT treatment increased mean yolk CORT levels ~3.7x higher than control eggs in _Lampropholis delicata_ [@crino2024eggs]. Then, eggs were incubated in one of the two previously mentioned temperature regimes (Cold or Hot) until hatching. These temperatures represent the upper and lower limit of the natural incubation temperatures for this species [@qualls2000post]. 

The number of eggs per clutch assigned to each hormone and temperature treatment was counterbalanced in a partial split-clutch design. At least one egg per clutch to each treatment, and the remaining eggs were randomly assigned to one of the treatments. When we found less than four eggs in a clutch, we assigned each egg randomly to one of the treatments.  

#### Numerical discrimination task  

Two weeks before starting the numerical discrimination task (see below), lizards were moved to the experimental arenas for acclimatisation. The arenas were individual medium-size (41 L x 29.7 W x 22 H cm) plastic containers provided with a shelter (9 L x 6 W x 1.5 H cm) on one of the sides and a water dish in the center (@fig-Methods B). Arenas were placed on seven different racks located in two experimental rooms. Each rack was associated with its own CCTV system (device model DVR-HP210475), allowing us to record lizards' behaviour during the experiment. Despite the conditions in the experimental rooms were the same as in the colony room, we counterbalanced the number of lizards per treatment in each rack to control for any potential effects of the room or the position of the lizard in the rack. During acclimatisation and throughout the experiment, lizards were fed with only one cricket daily, dusted with calcium and multivitamins (see protocol below), and water was supplied *ad libitum*. The temperature of both rooms was set to 22-24ºC, but we also provided a temperature gradient (24-32°C) using a heat cord along the center of the arena and heat lamps in a 12 h light: 12 h dark cycle.  

The numerical discrimination test consisted of a series of two-choice trials where lizards were presented with different numbers of food items. Each choice was placed on one of the two lateral platforms of a white 3D printed device (see @fig-Methods B, C) and then covered with a transparent Petri dish to prevent the lizard from obtaining the food. We performed five tests that differed in the ratio between both choices of crickets. Specifically, we compared: 1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4 crickets. The food consisted of small frozen crickets (*A. domestica*) that were thawed and dusted with calcium and multivitamins. We decided to use frozen crickets to avoid movement that would affect lizard behaviour [@cooper2024tell]. 

Lizards were fed frozen crickets for one month prior to the experiments to habituate them to eating frozen prey. To habituate lizards to the experimental conditions, frozen crickets were placed on top of one of the platforms and Petri dishes during each feeding for two weeks prior to experimental trials. The side where the food was placed was changed every day to avoid any side bias during the trials. However, to further control for side biases, the higher number of crickets was randomly placed on the right or the left platform. We also counterbalanced the number of individuals per treatment tested in the same type of trial each day.  

The crickets used during the experiment were all the same size, but to control for other quantitative traits we changed the orientation of the crickets as illustrated in @fig-Methods D. This approach created a conflict of information between choices, as horizontally oriented crickets could occupy the same space as a greater number of vertically oriented crickets. This allowed us to determine whether the lizards relied on discrete numerical units rather than non-numerical cues, such as total length, area, or volume [@agrillo2014spontaneous]. In addition, after the experiments, we conducted another set of trials to test whether the orientation of the crickets could affect lizards’ choice, but we found no effect of orientation (see _Supplementary Material - Prey orientation test_).  

```{r, fig-Methods}
#| label: fig-Methods
#| fig.cap: "Experimental design. Panel (**A**) shows the early environment manipulation procedures. (**B**) illustrates the arena where the tests were performed, while panel (**C**) indicates the measurements of the platform used for the experiments. Finally, panel (**D**) displays the types of numerical tests used and the orientation of the crickets in each test."

knitr::include_graphics("./Others/NUMDIS_FIG_1.png")

```

All tests were done between 1000-1200 hours when the lizards were most active. Each trial was performed daily for five days between the 17^th^ and 22^nd^ of May 2024. We recorded three main variables: i) _Latency_, defined as the time between the start of the test - when the platform was left in the enclosure - until the first interaction with one of the options; ii) First choice of the lizard (_Choice_), recorded as 1 if the lizard interacted first with the larger amount or 0 if not; and iii) _Interest_ shown for the higher amount of food (detailed below). We considered that the lizard interacted with the food when it touched the Petri dish with its snout or when the front half of the body was on top of the platform. For five minutes after the first interaction with one of the options, we recorded the time spent interacting with that option for a maximum of five minutes; we did this for both amounts of food independently of what was the first choice. We measured the interest shown for the higher amount of food (_Interest_) by subtracting the time interacting with the option with fewer crickets to the time spent interacting with the larger amount of food. If there was no interaction with one of the options during the test, we considered the time spent as zero for that option. When there was no interaction with any of the choices, both _Latency_, _Choice_, and _Interest_ were noted as NA. We also considered Interest as NA in a few cases where the animals managed to lift the dish and eat the prey; Latency and Choice were recorded and employed in the analyses. We excluded from the analyses all the individuals that did not make any choice in three or more tests. All the analyses were performed by PR, who was blind to the treatment of the lizards.   

Motivation plays a key role in animals' performance in spontaneous choice tests [@agrillo2014spontaneous; @bisazza2014experim]. To ensure that lizards remained motivated to forage, they were provided with only one cricket during both acclimatization and the numerical task (see above). During acclimatization, lizards were fed at the same time each day as the experiments were conducted. In the numerical task, lizards received a cricket immediately after the test and then fasted for more than 20 hours, which we expected would help standardize fasting levels across individuals. To further control for motivation, we excluded from our analyses any trials in which lizards did not interact with any options or did not eat the cricket provided after the test (n = 0 in both cases). Consequently, we do not consider motivation to be a major factor influencing our results (but see Discussion).  

#### Statistical analyses  
In our analyses, we fitted a multivariate Bayesian multilevel model using the brm function from the _brms_ package [@burkner2017brms] in R (version 2.8.2) [@R]. We ran four parallel MCMC chains of 3000 iterations for each model, with a warmup period of 1000 iterations. We checked that all MCMC chains converged (Rhat < 1.2) and were mixing effectively to ensure we had >1000 effective samples from the posterior distribution.   

We modelled the three main recorded behaviours: _Latency_, _Choice_, and _Interest_ as the response variables. We assumed normal distributions for Latency (log-transformed) and Interest [family = gaussian()]. The error structure for Choice was modeled using a Bernoulli distribution with a logit link function [family = Bernoulli(link = ‘logit’)]. We included test (1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4), hormone (CORT versus Control), incubation temperature (Cold versus Hot), and the three-way interaction as fixed factors. We also included in our predictors sex, and age. We did not find any effect of sex or age on Choice or Interest, but we found an effect on Latency (see Results). Regardless, we included both factors in all models. Age was centered to zero in the model, and we averaged the predicted values for males and females.  

We included lizard identity and clutch as random factors. _L. guichenoti_ lays up to two clutches per year [@joss1985reproductive]. Since egg collection was done during half of the breeding season, each clutch likely came from a unique mother, and so, clutch identity captures potential maternal effects.  

We used the posterior distributions of parameters from these models to test for between treatment differences in the ability to discriminate different numbers of crickets for each of the numerical tests. Because the posterior distributions were not always normally distributed, we report the median as the main measure of central tendency. We used the 95% Highest Posterior Density Intervals (95% HPDI) using the hdi function in bayestestR [@bayestestR] to test if the contrasts between treatments for all the variables, or the _Interest_ per each test was different form zero. Given Choice was Bernoulli, we modified our null hypotheses to test if differed from a probability of 0.5 as there were only two possible choices and if animals were choosing randomly we would predict each choice would have a 50% probability.  
 
#### Ethical note
Subjects were collected from a breeding colony that had been kept in the lab since 2019. All animals in this experiment were provided humane laboratory housing, thermoregulation opportunities, and light and humidity conditions (see above for details). Lizards in the colony received five to seven crickets per individual three times a week while the subjects in the experiment were fed once per day. All lizards were handled minimally to avoid stress. Experimental procedures and laboratory housing complied with Australian law and were approved by the Australian National University Animal Experimentation Ethics Committee (A2022_33). Upon completion of experimental trials, lizards were kept in their enclosure and will be euthanized following standard humane procedures once they reach the humane endpoint.  
 

## Results

```{r, data_process}
#| label: data_process
# Load the data and process it to get the main dfs
source(here("R", "data_process.R"))
```

```{r, models}
#| label: models
# Fitting the model and extraction of posteriors 
refit = FALSE
if(refit){
  # Get the formula and family of variables
  lat <- bf(log(latency) ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = gaussian())
  choice <- bf(choice ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = bernoulli(link = "logit"))
  int <- bf(compared_interest ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch),
    family = gaussian())
  # Fit the model
  model <- brm(lat + choice + int,
                chains = 4, cores = 4, iter = 4000, warmup = 1000, control = list(adapt_delta = 0.99, max_treedepth =12),
                data = data_num)
    # Write the model to a file
    saveRDS(model, file = here("output/models/model_num.rds"))
  } else {
      # Read the model from a file
      model <- readRDS(file = here("output/models/model_num.rds"))
  } 
# 
```

```{r, posteriors}
#| label: posteriors
# Code to extract posteriors from the model and get predicted values
source(here("R", "func.R"))
#
## Extract posteriors
posteriors <- as_draws_df(model)
# 
## Get predictions for every test and treatment based on the posteriors of the model. We used the function org_post (see func.R) to get the predictions.
#
# Latency
post_lat <- org_post("lat")
normality_results_lat <- check_normality(post_lat)
# Choice
post_choice <- org_post("choice")
prob_choice <- exp(post_choice)/(1 + exp(post_choice))
normality_results_choice <- check_normality(prob_choice)
write.csv(normality_results_choice, file = here("output/Checking/normality_results.csv"))
# Estimated interest for the higher amount of food
post_int <- org_post("int")
normality_results_int <- check_normality(post_int)
#
```

Overall, males showed lower latencies than females (median of the estimated effect of sex = `r {format_dec(median(posteriors$b_loglatency_sexm), 2)}`, 95% HPDI = [`r {format_dec(hdi(posteriors$b_loglatency_sexm, credMass = 0.95)[1], 2)}`, `r {format_dec(hdi(posteriors$b_loglatency_sexm, credMass = 0.95)[2], 2)}`]), and older individuals also made decisions faster (mean estimated effect of age = `r {format_dec(median(posteriors$b_loglatency_age),2)}`, 95% HPDI = [`r {format_dec(hdi(posteriors$b_loglatency_age, credMass = 0.95)[1], 2)}`, `r {format_dec(hdi(posteriors$b_loglatency_age, credMass = 0.95)[2],2)}`]; see Table S3 in _Supplementary Material_). However, we did not see any effect of age or sex on _Choice_ or _Interest_ (see _Supplementary Material_).  

```{r, fig-results}
#| label: fig-results
#| fig.cap: "Estimates of log-latency (Latency), the probability of choosing the larger number of crickets first (Choice), and the estimated interest in the larger number of crickets (Interest) for each of the numerical tests performed across different developmental treatments. The x-axis represents the estimate, and the y-axis is the posterior density of the estimates. The different colours indicate the different treatments. Points and bars represent the median and 95% Higest Density Intervals (95% HPDI) of the estimates, respectively. Vertical dashed lines in Choice and Interest graphs values 0.5 and 0, respectively. Asterisks indicate values significantly different from 0."
#
source(here("R", "func.R"))
#
#### A) Organise the df used for both parts of the figure for each variable
#
# First the df for violin plots for each variable using df_violin_plot function from func.r
df_viol_lat <- df_violin_plot("lat")
df_viol_choice <- df_violin_plot("choice")
df_viol_int <- df_violin_plot("int")
#
# Second the df for the points and bars plot for each variable using df_bars_plot function from func.r
df_bars_lat <- df_bars_plot("lat")
df_bars_choice <- df_bars_plot("choice")
df_bars_int <- df_bars_plot("int")
#
#### B) Make the plots for each variable using plotting function from func.r
#
fig_lat <- plotting("lat")
fig_choice <- plotting("choice") 
fig_int <- plotting("int")
#
#### C) Combine the plots and make final figure
fig_results <- plot_grid(fig_lat, fig_choice, fig_int, ncol = 1) +
  annotate("text", x = 0.305, y = 0.56, label = "*", size = 7, color = "black") + 
  annotate("text", x = 0.61, y = 0.505, label = "*", size = 7, color = "black")
ggsave("./output/figures/fig_results.png", plot=fig_results, width = 25, height = 25, units = "cm", dpi = 600)
knitr::include_graphics("./output/figures/fig_results.png")
```

Neither temperature, CORT, or their interaction affected performance in any of the tests, nor were there any clear patterns suggestive of an effect of the developmental environment on numerical discrimination (see Table 1 and @fig-results). Except for Hot-CORT lizards in 1 VS 3 tests or Cold-Control lizards in 2 VS 3 tests, the predicted probability of choosing the larger number of crickets first was not different from 0.5 (@fig-results; but also see Table S1 and Table S2 in _Supplementary Material_). Similarly, interest in the larger number of crickets (_Interest_) was not different from 0 in any of the tests (@fig-results; but also see Table S1 and Table S2 in _Supplementary Material_).  

_Table 1. Effects of temperature, CORT, and their interaction on Latency, Choice, and Interest in each of the numerical discrimination tests. The table shows the contrasts for each predictor (Temperature = [medianHot - medianCold]; Hormone = [medianControl - medianCORT]; and their Interaction = [(medianHot-Control - medianHot-CORT) - (medianCold-Control - medianCold-CORT)]). 95% Higest Density Intervals (95% HPDI) test the hypothesis that contrasts are different from zero._
```{r, tbl-data}
#| label: tbl-data
#| tbl-cap: "Effects of temperature, CORT, and their interaction on Latency, Choice, and Interest in each of the numerical discrimination tests. The table shows the contrasts for each predictor (Temperature = [medianHot - medianCold]; Hormone = [medianControl - medianCORT]; and their Interaction = [(medianHot-Control - medianHot-CORT) - (medianCold-Control - medianCold-CORT)]). 95% Higest Density Intervals (95% HPDI) test the hypothesis that contrasts are different from zero."
source(here("R", "func.R"))
#
# Making the df for each variable
#
## Initialize df_org as a list to store data frames for each variable
df_org <- list()
## Define variables and tests
variable <- c("Latency", "Choice", "Interest")
test <- c("1VS4", "1VS3", "2VS4", "2VS3", "3VS4")
## Loop over each variable
for(a in variable){
  # Select the original df to use depending on the variable
  if(a == "Latency"){
    post <- post_lat
  } else if(a == "Choice"){
    post <- prob_choice
  } else if(a == "Interest"){
    post <- post_int
  }
  df_tables <- data.frame()
  for(b in test){
    # Modify the df to get the values per each test
    post_mod <- post %>%
      dplyr::select(dplyr::matches(b))
    # Extract the required columns
    Cold_CORT <- post_mod[[paste0("X", b, "_Cold_CORT")]]
    Cold_Control <- post_mod[[paste0("X", b, "_Cold_Control")]]
    Hot_CORT <- post_mod[[paste0("X", b, "_Hot_CORT")]]
    Hot_Control <- post_mod[[paste0("X", b, "_Hot_Control")]]
    # Calculate effects and HDI values
    effect_hormone <- format_dec(median(c(Hot_Control, Cold_Control)) - median(c(Hot_CORT, Cold_CORT)), 1)
    effect_temp <- format_dec(median(c(Hot_CORT, Hot_Control)) - median(c(Cold_CORT, Cold_Control)), 1)
    interaction <- format_dec((median(Hot_Control) - median(Cold_Control)) - (median(Hot_CORT) - median(Cold_CORT)), 1)
    #
    hdi_hormone <- paste0("[", format_dec(hdi(c(Hot_Control, Cold_Control) - c(Hot_CORT, Cold_CORT))[1], 2), " , ",
                          format_dec(hdi(c(Hot_Control, Cold_Control) - c(Hot_CORT, Cold_CORT))[2], 2), "]")
    hdi_temp <- paste0("[", format_dec(hdi(c(Hot_CORT, Hot_Control) - c(Cold_CORT, Cold_Control))[1], 2), " , ",
                        format_dec(hdi(c(Hot_CORT, Hot_Control) - c(Cold_CORT, Cold_Control))[2], 2), "]")
    hdi_interaction <- paste0("[", format_dec(hdi((Hot_Control - Cold_Control) - (Hot_CORT - Cold_CORT))[1], 2), " , ",
                              format_dec(hdi((Hot_Control - Cold_Control) - (Hot_CORT - Cold_CORT))[2], 2), "]")
    # Define labels and values
    effects_predictors_names <- c("Hormone",
                          "Temperature",
                          "Interaction")
    values_predictors <- c(effect_hormone, effect_temp, interaction)
    values_hdi <- c(hdi_hormone, hdi_temp, hdi_interaction)
    # Create a temporary data frame for this loop iteration
    temporal_df <- data.frame(Predictor = effects_predictors_names,
                        Effect = values_predictors,
                        hdi = values_hdi,
                        Test = b,
                        stringsAsFactors = FALSE)
    # Merge the temporary data frame to the main df_tables
    df_tables <- rbind(df_tables, temporal_df)
  }
  df_tables$Variable <- a
  df_org[[a]] <- df_tables
}
# Combine all data frames in df_org into one data frame
table_df <- do.call(rbind, df_org)
# Convert the combined list into a data frame and modify for the table
table_df <- as.data.frame(table_df, stringsAsFactors = FALSE) %>%
  mutate(results = trimws(paste0(Effect, "\n", hdi))) %>%
  dplyr::select(Variable, Test, Predictor, results) %>%
  pivot_wider(names_from = Test, values_from = c(results), names_prefix = "")
#
#
# Making the table
#
## Table format
set_flextable_defaults(
 font.family = "Arial",
 font.size = 9)
# Create the table
real_table <- flextable(table_df) %>%
    align(align="center", part="all") %>% 
    add_header_row(values = c("", "Tests"), colwidths = c(2, 5)) %>%
    flextable::compose(i = c(3,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
    flextable::compose(i = 2, j = 1, value = as_paragraph("log(latency)"), part = "body") %>%
    flextable::compose(i = 5, j = 1, value = as_paragraph("log(odds)"), part = "body") %>%
    hline(i = c(3,6), j = c(1:7), part = "body") %>% # To make some horizontal lines 
    set_table_properties(layout = "autofit", width = 1)
real_table
```


## Discussion
Contrary to our predictions that numerical cues would influence foraging decisions, and that elevated prenatal CORT or cold incubation temperatures would impair numerical discrimination, we found no significant differences across tests or treatments. Our results indicate that lizards did not discriminate between different numbers of crickets, nor did their performance vary under our experimental conditions. Overall, these findings suggest that _L. guichenoti_ did not use numerical or other potential quantitative cues for foraging decisions.    

#### Foraging context may influence prey number discrimination in reptiles  
Lack of numerical discrimination in _L. guichenoti_ may be due to insectivorous lizards relying on other cues, such as movement or size, for foraging decisions. In studies where reptiles discriminated between different amounts of food, the relevant stimuli involved either vegetables [@gazzola2018continuous; @szabo_spontaneous_2021] or large quantities (e.g., 5 vs. 10)[@recio_prey_2021]. In contrast, when _Podarcis siculus_ were presented different numbers of _Musca domestica_ larvae in a spontaneous choice test, the lizards failed to discriminate between quantities despite showing high quantitative skills when prey size was the main cue [@miletto2017quantitative] or when tested using training procedures [@miletto2018quantity]. Notably, the numbers of food items employed in @miletto2017quantitative were always fewer than four. Spontaneous choice tests assume that animals should select the most appropriate quantity, which may not necessarily be the largest one [@agrillo2014spontaneous]. This occurrs if the costs of selecting the larger option outweigh the benefits. For example, when presented two groups with different numbers of conspecifics or if prey handling costs are related to larger quantitative traits like size [@agrillo2014spontaneous]. It could be that the perceived handling costs of larger numbers of prey affected lizard response in our study. Nevertheless, in that scenario, we would still expect animals to exhibit a preference, even if for the smaller amount of food. Additionally we would have expected body size to influence lizards choices, as larger animals may be more adept at handling a greater number of prey items. @miletto2017quantitative did not report any effect of body size, and age - a proxy for size - did not affect _L. guichenoti_'s _Choice_ or _Interest_ in our study. The absence of preference in _P. siculus_ and _L. guichenoti_ suggests that the benefits of selecting a larger number of prey are not different from selecting fewer. For instance, when considering hunting groups of 1 VS 4 or 2 VS 4 crickets, the probability of success might be similar. Furthermore, while one individual handles a prey item within the patch, other conspecifics could capture the rest. As a result, insectivorous lizards might not have evolved a preference for larger patches of prey, at least with small numbers [see @recio_prey_2021].  

Conversely, our findings may be influenced by the experimental design. In our study, we rotated the position of the crickets in the choice with fewer items to create a situation where the numerical cues (fewer items) conflicted with other quantitative cues associated with numerosity. This approach was intended to control for other quantitative cues that could be used by lizards to make decisions [@cooper2024tell]. However, this manipulation could have made the task more challenging for lizards, potentially affecting their performance. Indeed, it is possible that _L. guichenoti_ uses multiple quantitative cues simultaneously during foraging decisions. When those cues conflict, the preference for one cue over another might vary between individuals, potentially producing the results observed here. Future studies should explore the use of other quantitative cues in _L. guichenoti_ and how they interact with numerical information. Such studies would enhance our understanding of how _L. guichenoti_ integrates different quantitative cues during foraging, providing insights into their decision-making processes and overall quantitative abilities.  

#### Foraging behaviour is robust to early environmental experiences  
Although the effects of early environment on cognition is widely studied, little attention has been paid to its impacts on numerical discrimination. To the best of our knowledge, there is only one study examining how developmental conditions influence numerical abilities [@vila_pouca_quantity_2019]. Given the potent effects of early environment on cognition and brain development [@szuran_water_1994; @zhu_prenatal_2004; @amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @lui2017chronic], it is crucial to explore how early environmental conditions shape numerical abilities across taxa.  

In our experimental design, prenatal treatments did not influence numerical discrimination in _L. guichenoti_, but we cannot discount the possibility that early environmental factors may affect numerical discrimination under other approaches or contexts. Based on previous studies showing the effects of prenatal temperature and GCs on cognitive abilities in reptiles and other groups [@szuran_water_1994; @zhu_prenatal_2004; @amiel_hotter_2012; @amiel_egg_2014; @clark_colour_2014; @amiel_effects_2017; @lui2017chronic], we predicted that lower incubation temperatures and exposure to CORT will impair lizards' performance, especially in those tests with higher ratios [@agrillo2014spontaneous; @nieder2018evolution]. However, we did not find any effect of the experimental treatments on _L. guichenoti_'s behaviour when tested in a numerical task. Both GCs and thermal environment can exert differential effects on distinct areas of the brain. For example, in the eastern three-lined skink (_Bassiana dupeyerri_), elevated incubation temperatures increased cell density in the medial cortex - linked to learning process and memory - but did not impact cell density in other nuclei [@amiel_effects_2017]. Similarly, impairments in spatial learning in rats [@haq_prenatal_2021] are likely associated with the greater density of GCs receptors in the hippocampus compared to other regions of the brain [@siegel_2006]. Researchers have proposed that non-verbal number representation is processed by two types of systems: one for small sets (≤ 4) that tracks and encodes objects as individual entities, and another for larger numerosities that operate through estimation processes [@nieder2005counting; @cantlon2009beyond; @hyde2011two]. While it remains unknown which areas of the reptiles' brain encode numerical information, our results suggest that the brain regions involved in discrete numerical representation (≤ 4 items) might be robust to the effects of prenatal CORT and temperature in _L. guichenoti_.  

Alternatively, it is plausible that treatment effects are masked by the overall absence of discrimination between numbers of prey items across most of the tests. In this regard, motivation is a key factor in spontaneous choice tests [@agrillo2014spontaneous; @bisazza2014experim]. Both developmental CORT and incubation temperature can affect metabolic rate (hereafter MR) which could affect motivation in food based learning paradigms [@noble_developmental_2018; @cossin2022effect; but see @crino_corticosterone_2014-learn]. Although still possible, this explanation is less likely in our study because we controlled for motivation by providing only one cricket per day and fasting lizards for more than 20 hours before the test. In addition, we excluded tests where lizards did not interact with any of the options or did not eat the cricket provided after the test. Further studies should explore the effects of prenatal conditions on motivation and how it may affect the outcome of cognitive choice tests in reptiles.    

#### Conclusion
Our study is, to the best of our knowledge, the first to explore the impact of prenatal conditions on numerical abilities in reptiles. Our findings suggest that _L. guichenoti_ does not rely on numerical information for foraging decisions and that their performance does not vary due to prenatal treatments. These results indicate that early environmental conditions, such as incubation temperature and CORT exposure, may not affect numerosity in this species. However, it is critical to note that the methodologies employed in this study may not have fully captured the nuances of numerical cognition in _L. guichenoti_. Therefore, we recommend that future studies employ a broader array of tests and paradigms, including training-based tasks, larger sets of stimuli, and other sensory modalities, to more comprehensively assess numerical competence in this and related species. Such work will be fundamental in unravelling early environmental factors' effects on reptiles' cognitive abilities and advancing our understanding of numerical discrimination across taxa.  

## Data accessibility  
All data, data description, and R code are available in public repository [https://github.com/Pablo-Recio/CORT-Temp_Numerical](https://github.com/Pablo-Recio/CORT-Temp_Numerical).  

## Declaration of AI use  
We declare Chat GPT was used for questions related to coding and data analyses. All other parts of the manuscript were written by the authors and those parts where AI were used were checked and modified accordingly by the authors.  

## Authors' contributions  
PR: conceptualization, methodology, data collection, data curation, formal analysis, writing—original draft, writing—review and editing; DL: data collection, writing—review and editing; OC: conceptualization, writing—review and editing; CF: conceptualization, funding acquisition, writing—review and editing; AP: data collection, writing—review and editing; DN: conceptualization, methodology, funding acquisition, project administration, resources, supervision, writing—review and editing.  
All authors gave final approval for publication and agreed to be held accountable for the work performed therein.  

## Conflict of interest declaration  
We declare we have no competing interests.  

## Funding  
This work was supported by a National Australian University PhD scholarship (PR), and the Australian Research Council (grant no. DP210101152) to DN and CRF.  

## Acknowledgements  
We thank the help and assistance of our lab technicians Benjamin Durant and Michelle Stephens for taking care of the lizards. We are also grateful ANU MakerSpace, where we designed and built the prototypes of the 3D-printed platforms. Finally, we wish to acknowledge the anonymous reviewers for their valuable feedback on the manuscript.  

## References
<div id="refs"></div>

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

# Suplementary Material

#### Effects of treatments on numerical discrimination using the estimates and the raw data

_Table S1.- Median and 95% Higest Density Intervals (95% HPDI) of the estimated probability of choosing first the higher amount (Choice) and the estimated interest for the higher amount of food (Interest) per treatment group for each of the numerical tests performed. 95% HPDI test the hypothesis that Choice = 0.5, and Interest = 0, which would indicate a preference towards one of choices._
```{r, tbl-disc}
#| label: tbl-disc
#| tbl-cap: "Median and 95% HPDI of the estimated probability of choosing first the higher amount (Choice) and the estimated interest for the higher amount of food (Interest) per treatment group for each of the numerical tests performed. 95% HPDI test the hypothesis that Choice = 0.5, and Interest = 0, which would indicate a preference towards one of choices."
#
source(here("R", "func.R"))
#
# Making the df for each variable
#
## Initialize df_org as a list to store data frames for each variable
disc_list <- list()
## Define variables and tests
variable <- c("Choice", "Interest")
test <- c("1VS4", "1VS3", "2VS4", "2VS3", "3VS4")
## Loop over each variable
for(c in variable){
  # Select the original df to use depending on the variable
  if(c == "Choice"){
    post <- prob_choice
    val <- 0.5
  } else if(c == "Interest"){
    post <- post_int
    val <- 0
  }
  df_disc <- data.frame()
  for(d in test){
    # Modify the df to get the values per each test
    post_mod <- post %>%
      dplyr::select(dplyr::matches(d))
    # Extract the required columns
    Cold_CORT <- post_mod[[paste0("X", d, "_Cold_CORT")]]
    Cold_Control <- post_mod[[paste0("X", d, "_Cold_Control")]]
    Hot_CORT <- post_mod[[paste0("X", d, "_Hot_CORT")]]
    Hot_Control <- post_mod[[paste0("X", d, "_Hot_Control")]]
    # Calculate medians and 95% HPDI
    Cold_CORT_median <- format_dec(median(Cold_CORT), 2)
    Cold_Control_median <- format_dec(median(Cold_Control), 2)
    Hot_CORT_median <- format_dec(median(Hot_CORT), 2)
    Hot_Control_median <- format_dec(median(Hot_Control), 2)
    #
    int_Cold_CORT <- paste0("[", format_dec(hdi(Cold_CORT, credMass = 0.95)[1], 2), " , ",
                            format_dec(hdi(Cold_CORT, credMass = 0.95)[2], 2), "]")
    int_Cold_Control <- paste0("[", format_dec(hdi(Cold_Control, credMass = 0.95)[1], 2), " , ",
                            format_dec(hdi(Cold_Control, credMass = 0.95)[2], 2), "]")
    int_Hot_CORT <- paste0("[", format_dec(hdi(Hot_CORT, credMass = 0.95)[1], 2), " , ",
                            format_dec(hdi(Hot_CORT, credMass = 0.95)[2], 2), "]")
    int_Hot_Control <- paste0("[", format_dec(hdi(Hot_Control, credMass = 0.95)[1], 2), " , ",
                            format_dec(hdi(Hot_Control, credMass = 0.95)[2], 2), "]")
    # Define labels and values
    treatment_names <- c("Cold-CORT (n = 20)", "Cold-Control", "Hot-CORT", "Hot-Control")
    values_medians <- c(Cold_CORT_median, Cold_Control_median, Hot_CORT_median, Hot_Control_median)
    values_int <- c(int_Cold_CORT, int_Cold_Control, int_Hot_CORT, int_Hot_Control)
    # Create a temporary data frame for this loop iteration
    temporal_df <- data.frame(Treatment = treatment_names,
                        Effect = values_medians,
                        int = values_int,
                        Test = d,
                        stringsAsFactors = FALSE)
    # Merge the temporary data frame to the main df_tables
    df_disc <- rbind(df_disc, temporal_df)
  }
  df_disc$Variable <- c
  disc_list[[c]] <- df_disc
}
# Combine all data frames in df_org into one data frame
disc_df <- do.call(rbind, disc_list)
# Convert the combined list into a data frame and modify for the table
disc_df_final <- as.data.frame(disc_df, stringsAsFactors = FALSE) %>%
  mutate(int = gsub("^= ", "", int)) %>%
  pivot_wider(names_from = Variable, values_from = c(Effect, int), names_prefix = "") %>%
  dplyr::select(Test, Treatment, 
                Effect_Choice, int_Choice,
                Effect_Interest, int_Interest) %>%
  mutate(Treatment = factor(Treatment, levels = c("Hot-Control (n = 20)",
                                      "Hot-CORT (n = 20)",
                                      "Cold-Control (n = 20)",
                                      "Cold-CORT (n = 20)"))) %>%
data.frame()
#
#
# Making the table
#
## Table format
set_flextable_defaults(
 font.family = "Arial",
 font.size = 10)
# Create the table
disc_table <- flextable(disc_df_final) %>%
    set_table_properties(width = 1) %>%
    align(align="center", part="all") %>% 
    flextable::compose(i = c(2:4,6:8,10:12,14:16,18:20), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
    flextable::add_header_row(values = c("", "Choice", "Interest"), colwidths = c(2, 2, 2)) %>%
    flextable::compose(i = 2, j = c(3,5), value = as_paragraph("Median"), part = "head") %>% 
    flextable::compose(i = 2, j = c(4,6), value = as_paragraph("95% HPDI"), part = "head") %>% 
    hline(i = c(4,8,12,16), j = c(1:6), part = "body") %>% # To make some horizontal lines
    vline(i = c(1:20), j = 2, part = "body") %>% # To make some vertical lines
    vline(i = c(1:20), j = 4, part = "body") %>% # To make some vertical lines
    vline(i = c(1,2), j = 2, part = "head") %>%
    vline(i = c(1,2), j = 4, part = "head") 
disc_table
```

_Table S2.- Performance of each treatment in each of the numerical tests using the raw data. For the variable Latency and Interest, we show the median and the 95% CI. For the varaible Choice, we show the proportion of individuals that chose the higher number of crickets first._

```{r, tbl-discraw}
#| label: tbl-discraw
#| tbl-cap: "Performance of each treatment in each of the numerical tests using the raw data. For the variable Latency and Interest, we show the median and the 95% CI. For the varaible Choice, we show the proportion of individuals that chose the higher number of crickets first."
#
data_table_raw <- data_num %>%
  dplyr::select(trt, test_type, latency, choice, compared_interest) %>%
  group_by(trt, test_type) %>%
  summarize(
    mean_latency = format_dec(mean(latency, na.rm = TRUE), 2),
    ci_latency_lower = format_dec(quantile(latency, 0.025, na.rm = TRUE), 2),
    ci_latency_upper = format_dec(quantile(latency, 0.975, na.rm = TRUE), 2),
    mean_interest = format_dec(mean(compared_interest, na.rm = TRUE), 2),
    ci_interest_lower = format_dec(quantile(compared_interest, 0.025, na.rm = TRUE), 2),
    ci_interest_upper = format_dec(quantile(compared_interest, 0.975, na.rm = TRUE), 2),
    Choice = as.character(sum(choice == 1, na.rm = TRUE))
  ) %>%
  ungroup() %>%
  mutate(
    ci_latency = paste0("[", ci_latency_lower, " , ", ci_latency_upper, "]"),
    ci_interest = paste0("[", ci_interest_lower, " , ", ci_interest_upper, "]"),
  ) %>%
  mutate(
    Latency = trimws(paste0(mean_latency, "\n", ci_latency)),
    Interest = trimws(paste0(mean_interest, "\n", ci_interest))
  ) %>%
  mutate(trt = recode(trt, 
            "B_23" = "Cold-CORT (n = 20)", 
            "A_23" = "Cold-Control (n = 20)", 
            "B_28" = "Hot-CORT (n = 20)", 
            "A_28" = "Hot-Control (n = 20)")) %>% # To order the treatments
  dplyr::select(test_type, trt, Latency, Choice, Interest) %>% 
  pivot_longer(cols = c(Latency, Choice, Interest), 
               names_to = "variable", 
               values_to = "value") %>%
  pivot_wider(names_from = test_type, 
              values_from = value) %>%
  dplyr::select(variable, trt, "1 VS 4", "1 VS 3", "2 VS 4", "2 VS 3", "3 VS 4") %>%
  mutate(variable = factor(variable, levels = c("Latency", "Choice", "Interest")),
         trt = factor(trt, levels = c("Hot-Control (n = 20)",
                                      "Hot-CORT (n = 20)",
                                      "Cold-Control (n = 20)",
                                      "Cold-CORT (n = 20)"))) %>%
  arrange(variable, trt) %>%
data.frame()
data_table_raw_b <- data_table_raw %>%
  rename(
    Variable = variable, 
    Treatment = trt, 
    "1 VS 4" = X1.VS.4,
    "1 VS 3" = X1.VS.3,
    "2 VS 4" = X2.VS.4,
    "2 VS 3" = X2.VS.3,
    "3 VS 4" = X3.VS.4) 
#
#
# Table format
set_flextable_defaults(
 font.family = "Arial",
 font.size = 10)
# Create the table
table_raw <- flextable(data_table_raw_b) %>%
  # Add your custom header rows
  flextable::add_header_row(values = c("", "Tests", ""), colwidths = c(4, 1, 2)) %>%
  # Take away some text
  flextable::compose(i = c(2,3,4,6,7,8,10,11,12), j = 1, value = as_paragraph(""), part = "body") %>%
  hline(i = c(4,8), j = c(1:7), part = "body") # To make some horizontal lines
table_raw
```



```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Model results

_Table S3A.- Summary of the model fitted for loglatency (Latency)_

```{r, summary_org}
#| label: summary_org
#
## Get the summary of the posteriors to get the estimates of each parameter of the model
sum <- summary(posteriors)
## Extract the values of the summary
sum_2 <- as.data.frame(sum) %>%
  dplyr::select(-mad) %>%
  filter(!str_detect(variable, "^r_"))
sum_df <- sum_2 %>%
  mutate(across(where(is.numeric), ~ sprintf(paste0("%.", 2, "f"), .)))  
```


```{r, tbl-summary_lat}
#| label: tbl-summary_lat
#| tbl-cap: "Summary of the model fitted for the latency variable."
#
source(here("R", "func.R"))
## Get df only for latency
df_sum_lat <- sum_table_org(sum_df, "lat")
## Make table
table_sum_lat <- flextable(df_sum_lat)
table_sum_lat
```


_Table S3B.- Summary of the model fitted for Choice_   
```{r, tbl-summary_choice}
#| label: tbl-summary_choice
#| tbl-cap: "Summary of the model fitted for the choice variable."
#
source(here("R", "func.R"))
## Get df only for choice
df_sum_choice <- sum_table_org(sum_df, "choice")
## Make table
table_sum_choice <- flextable(df_sum_choice)
table_sum_choice
```


_Table S3C.- Summary of the model fitted for Interest_  
```{r, tbl-summary_int}
#| label: tbl-summary_int
#| tbl-cap: "Summary of the model fitted for the interest variable."
#
source(here("R", "func.R"))
## Get df only for interest
df_sum_int <- sum_table_org(sum_df, "int")
## Make table
table_sum_int <- flextable(df_sum_int)
table_sum_int
```


_Table S3D.- Summary of the model fitted for other effects_  
```{r, tbl-summary_other}
#| label: tbl-summary_other
#| tbl-cap: "Summary of the model fitted for other effects."
#
source(here("R", "func.R"))
## Get df only for interest
df_sum_other <- sum_df %>%
  filter(!str_detect(variable, "^b_"))
## Make table
table_sum_other <- flextable(df_sum_other)
table_sum_other
```


```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Testing potential side biases

_Table S4.- Number of individuals per treatment that chose the right (R) or left (L) side in each of the numerical tests. p-value indicates the result of the binomial test comparing the number of choices between sides. 
```{r, tbl-sides}
#| label: tbl-sides
#| tbl-cap: "Number of individuals per treatment that chose the right (R) or left (L) side in each of the numerical tests. p-value indicates the result of the binomial test comparing the number of choices between sides."
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_sides <- data_num %>%
  group_by(trt, test_type) %>% # Group by treatment and test
  summarise(
    right_choices = sum(side_choice == "Right", na.rm = TRUE),
    left_choices = sum(side_choice == "Left", na.rm = TRUE),
  ) %>% # Count the number of correct choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = right_choices + left_choices,  # Calculate total choices
    p_value = format_dec(binom.test(right_choices, total_choices)$p.value, 2)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(choices_Right_Left_p = paste0("R = ", right_choices, " | L = ", left_choices, " , p = ", p_value), # Create a column with the choices
        trt = recode(trt, 
                 "B_23" = "CORT-Cold (n = 20)", 
                 "A_23" = "Control-Cold (n = 20)", 
                 "B_28" = "CORT-Hot (n = 20)", 
                 "A_28" = "Control-Hot (n = 20)")) %>% # To order the treatments
  dplyr::select(trt, test_type, choices_Right_Left_p) %>% # Remove unused columns
  pivot_wider(names_from = test_type, values_from = c(choices_Right_Left_p)) %>% # To split between tests
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
sides_table <- flextable(data_sides) %>%
  compose(j = 1, value = as_paragraph(""), part = "header") %>%
  compose(j = 2, value = as_paragraph("1 VS 4"), part = "header") %>%
  compose(j = 3, value = as_paragraph("1 VS 3"), part = "header") %>%
  compose(j = 4, value = as_paragraph("2 VS 4"), part = "header") %>%
  compose(j = 5, value = as_paragraph("2 VS 3"), part = "header") %>%
  compose(j = 6, value = as_paragraph("3 VS 4"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
sides_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Prey orientation test
We performed a choice test to investigate if the orientation of crickets affected the lizards’ choice. We used the same platform and Petri dish as in the numerical discrimination task, but we placed one cricket on each side of the platform, one oriented vertically in respect to the shelter position (see @fig-Methods B) and the other one horizontal to the shelter. We performed a unique trial randomising the position of the orientation of the cricket. We recorded the number of individuals that chose the cricket oriented vertically and horizontally. Results are shown in the table below.

_Table S4.- Number of individuals per treatment that chose the cricket oriented horizontally (Horizontal) or vertically (Vertical) in our control tests. p-value indicates the result of the binomial test comparing the number of choices between both choices._
```{r, tbl-orientation}
#| label: tbl-orientation
#| tbl-cap: "Number of individuals per treatment that chose the cricket oriented horizontally (Horizontal) or vertically (Vertical) in our control tests. p-value indicates the result of the binomial test comparing the number of choices between both choices."
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_or_res <- data_orient %>%
  mutate(choice_or = ifelse(choice_horizontal == 0, "Vertical", "Horizontal")) %>%
  dplyr::select(trt, choice_horizontal, choice_or) %>%
  group_by(trt) %>% # Group by treatment and test
  summarize(
    Horizontal_Count = sum(choice_or == "Horizontal"),
    Vertical_Count = sum(choice_or == "Vertical")
  ) %>% # Count the number of horizontal and vertical choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = Horizontal_Count + Vertical_Count,  # Calculate total choices
    p_value = format_dec(binom.test(Horizontal_Count, total_choices)$p.value, 3)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(trt = recode(trt, 
            "B_23" = "Cold-CORT (n = 20)", 
            "A_23" = "Cold-Control (n = 20)", 
            "B_28" = "Hot-CORT (n = 20)", 
            "A_28" = "Hot-Control (n = 20)"),
          trt = factor(trt, levels = c("Hot-Control (n = 20)",
                                  "Hot-CORT (n = 20)",
                                  "Cold-Control (n = 20)",
                                  "Cold-CORT (n = 20)"))) %>% # To order the treatments
  dplyr::select(trt, Horizontal_Count, Vertical_Count, p_value) %>% # Remove unused columns
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
orient_table <- flextable(data_or_res) %>%
  flextable::compose(j = 1, value = as_paragraph(""), part = "header") %>%
  flextable::compose(j = 2, value = as_paragraph("Horizontal"), part = "header") %>%
  flextable::compose(j = 3, value = as_paragraph("Vertical"), part = "header") %>%
  flextable::compose(j = 4, value = as_paragraph("p-value"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
orient_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Searching for relevant literature
To look for relevant literature about the effects of early environment on numerical discrimination, we searched in the Web of Science and Scopus using the terms on respectively. The queries employed are detailed below. We looked for manuscripts for all years available. The last search was conducted on the 11^th^ of October 2024; the results below refer to this last search.    

We found 24 articles on Web of Science and 22 on Scopus, plus one preprint on Scopus. Out of all the documents, only one study was relevant to our search: @vila_pouca_quantity_2019. That study appeared in both databases and was the only one that explored the effects of early environment on numerical abilities.

```{r, fig-searchWOS}
#| label: fig-searchWOS
#| fig.cap: "Search query on Web of Science."

knitr::include_graphics("./Others/Web of Science Search results.png")

```

```{r, fig-searchScopus}
#| label: fig-searchScopus
#| fig.cap: "Search query on Scopus."

knitr::include_graphics("./Others/Scopus - Document search results.png")

```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Checking the model plots  
```{r, checking_model, out.width="70%", fig.align="center"}
# Chunk for plotting the model
## Initial plot
plot(model)
#
## pp_checks
pp_check(model, resp = "loglatency")
pp_check(model, resp = "choice")
pp_check(model, resp = "comparedinterest")
```
