---
docx: 
bibliography: "./bib/refs.bib"
csl: "./bib/behavioral-ecology-and-sociobiology.csl"
reference-doc: "./bib/tmpl.docx"
execute:
  echo: false
  error: false
  cache: false
  warning: false
link-citations: true
crossref:  
  fig-title: Fig    # (default is "Figure")
  title-delim: —     # (default is ":")
  fig-prefix: Fig.   # (default is "Figure")
  tbl-prefix: Table  # (default is "Table")
editor_options: 
  chunk_output_type: console
---

```{r, packages}
#| label: packages
pacman::p_load(tidyverse, flextable, emmeans, DHARMa, brms, here, ggplot2, lme4, zoo, lmerTest, broom, tidybayes, forcats, MASS,
fitdistrplus, DHARMa)
```

## Introduction  

- Quantitative abilities and its importance
The knowledge of quantities and the relation among them is one of the highest properties of cognition (Reznikova 2018). Among those numerical competences, the simplest ability is to make judgments and comparisons between “more” versus “less” (Reznikova 2007; Stancher et al. 2015), which is widespread in the animal kingdom (Vonk and Beran 2012; Beran et al. 2014). Sensitivity to relative differences in quantity might be adaptive in several situations (Nieder 2017, 2018). For instance, female lions (Panthera leo) seem to use numerical assessment of possible rivals to cope with or avoid social contests (McComb et al. 1994). Moreover, the ability to correctly estimate quantities is also associated with, for example, navigation (Chitka and Geiger 1995), choosing larger groups of potential mates (Carazo et al. 2009) and/or social companions (Bisazza et al. 2010), or increasing foraging efficiency (Uller et al. 2003).
In this sense, the literature is plenty of studies employing the spontaneous choice approach in many animals (e.g., see Carazo et al. 2009; Pahl et al. 2013 for invertebrates; Bisazza et al. 2010; Gómez-Laplaza and Gerlai 2013; Mehlis et al. 2015 for fishes; Uller et al. 2003; Krusche et al. 2010; Stancher et al. 2015 for amphibians; Garland et al. 2012 for birds; Ferkin et al. 2005; Abramson et al. 2011; Mahamane et al. 2014; Cox and Montrose 2016; Plotnik et al. 2019 for mammals) and also of research that explores numerical abilities with training procedures (e.g., see Gross et al. 2009; Pahl et al. 2013; Howard et al. 2018, 2019, for invertebrates; Bisazza et al. 2014 for fishes; Nieder 2017 for birds; Kilian et al. 2003; Addessi et al. 2008; Vonk and Beran 2012; Vonk 2014; Beran and Parrish 2016; Nieder 2017 for mammals).

- Different ways to test numerical abilities
There are two main approaches to study numerical abilities: spontaneous choice tests and training procedures. In spontaneous choice tests, experimenters present to subjects two groups of biologically relevant stimuli that differ in numerosity, under the assumption that animals should select the most appropriate quantity (e.g. the larger amount of food) (Agrillo and Bisazza 2014; Cox and Montrose 2016). In training
procedures, animals must learn a numerical rule to receive a reward (Agrillo and Bisazza 2014; Miletto-Petrazzini et al. 2018). Both experimental approaches have some advantages and disadvantages (reviewed in Agrillo and Bisazza 2014). In spontaneous choice tests, animals exhibit their natural behavior, enabling interspecific comparisons and the acquirement of ecological issues related to numerousness (Krusche et al. 2010; Abramson et al. 2011). However, motivation plays a key-role in spontaneous choice tests (Agrillo and Bisazza 2014), which implies that the absence of results might not be due to the lack of skills to solve the numerical task. Also, individual preferences may arise in this kind of procedures and, hence, a large sample of subjects is needed to consider inter-individual variability. Finally, it could be difficult, but necessary, to control for continuous variables such as area, density or movement (Agrillo and Bisazza 2014; Mehlis et al. 2015). Regardless, both methods are considered complementary and necessary to draw a firm picture of the numerical abilities of a species (Miletto-
Petrazzini et al. 2018). 

- The role of early environment on the development of cogition
The conditions in which organisms develop can be altered by the circumstances faced by their parents. For instance, exposing threespine sticklebacks females to a model predator during ovulation, affected their offspring’s tedency to use social cues (Feng et al., 2015). Under stressful situations, animal’s sensory systems detect and transmit environmental signals to instigate adaptive physiological and behavioural adjustments – responses that are mediated by glucocorticoids (GCs) (Sapolsky et al., 2000). Glucocorticoids can be transmitted to offspring
and influence their phenotype and development t 46 hrough transgenerational effects (Crino et al., 2023). In addition to the environments experienced by parents, offspring also experience potentially stressful environmental conditions that can interact with or amplify parental effects. For example, human disturbance alters snapping turtles’ nest-site choice, ultimately impacting the temperature at which eggs are incubated (Kolbe & Janzen, 2002). Because animals’ responses to abrupt changes in temperature are mediated by GCs (Crino et al., 2023), and this response can affect animals’ decision-making while nesting, GCs transmission and early thermal environment are predicted to interact to shape offspring phenotype. Both GCs and temperature are known to exert potent effects on brain development (Amiel et al., 2017; Coomber et al., 1997; Jonson et al., 1976; Zhu et al., 2004) and cognition (Clark et al., 2014; Lui et al., 2017).
    - The role of stress hormones on the development of numerical abilities
      NOTHING DONE?
    - The role of temperature on the development of numerical abilities
      Port Jackson shark eggs were incubated and reared at current and projected end-of-century temperatures (+ 3 °C). We tested juvenile’s learning ability with a quantity discrimination task. The mortality rate of sharks reared in warm water was 41.7% compared with no mortality in the present-day sharks. Contrary to expectations, our results suggest that surviving hatchlings from the elevated-temperature group took fewer days to reach learning criterion and had a higher proportion of correct choice compared with hatchlings reared under present conditions. Additionally, this is the first data suggesting that sharks can discriminate different quantities (Vila-Pouca et al., 2019).

- Numerical abilities in reptiles
    - Learned num abilities
    - Spontaneous discrimination
In contrast, in reptiles, research of quantity discrimination is scarce and contradictory. Soldati et al. (2017) taught red-footed tortoises (Chelonoidis carbonaria) to associate cards of two colors to different volumes of reward and tested their choices afterward. In that succeeding experiment, tortoises showed a clear preference for the color card associated with a greater amount of food, thus concluding that discrimination between quantities is present in this species. Similarly, Hermann’s tortoises (Testudo hermanni) also proved to discriminate food by numerosity or size in spontaneous choice tests rating from 0.25 to 0.75 (Gazzola et al. 2018). In contrast, other studies suggest different results; in the Italian wall-lizard (Podarcis siculus), spontaneous choice tests showed no numerical discrimination abilities by this lizard (Miletto-Petrazzini et al. 2017), although learning procedures demonstrated an ability to discern between small close numbers (2 versus 4) (Miletto-Petrazzini et al. 2018). **Check new papers: Lin in turtles, Szabo in lizards, etc.**

- The role of early environment on reptiles cognition
Both GCs and temperature are known to exert potent effects on brain development (Amiel et al., 2017; Coomber et al., 1997) and cognition (Clark et al., 2014), but little is known about how they affect numerical discrimination. Most studies have reported better performance in different associative learning and motor tasks when incubated at higher temperatures (Amiel et al., 2014; Amiel & Shine, 2012; Clark et al., 2014). Studies that have reported cold-incubated lizards to learning faster (Abayarathna & Webb, 2020; Dayananda & Webb, 2017) used incubation temperatures far beyond the natural range in their hot treatments and it is unclear how such conditions relate to wild environments. Furthermore, sensorial capacities: **Studies from Burger** | **CORT and cognition in reptiles** | **CORT and brain in reptiles**

- Hypotheses
    - We expect that lizards incubated at high temperatures will have a better performance in the numerical discrimination task than those incubated at low temperatures.
    - We expect that lizards incubated with CORT will have a worse performance in the numerical discrimination task than those incubated with the vehicle.
    - We expect that the effect of CORT on the performance of the numerical discrimination task will be more pronounced in lizards incubated at low temperatures than in those incubated at high temperatures.
- Predictions:
    - Lizards incubated at high temperatures will discriminate better quantities even with low ratios (lower latencies, choose large amount more often, more interested in larger amounts - i.e. "fail" less tests).
    - Lizards incubated with CORT will discriminate worse quantities even with high ratios (higher latencies, choices not different from chance, equally interested in both amounts of food - i.e. "fail" more tests).
    - The effect of CORT on the performance of the numerical discrimination task will be more pronounced in lizards incubated at low temperatures than in those incubated at high temperatures (i.e. CORT-Cold will "fail" more tests than anyone else).

## Methods  

#### Husbandry  
*Breeding colony* -- Lizards tested in out experiment came from a breeding colony established in the lab since 2019. The colony consists of approx. 180 adults of and _L. guichenoti_ housed in commonal containers (41.5 L x 30.5 W x 21 H cm) with six lizards (2 males and 4 females) per enclosure. Enclosures are provided with non-stick matting, shelter, and several small water dishes filled daily; and lizards are fed mid-size crickets (*Acheta domestica*) three days a week. Crickets are dusted with calcium weekly and multivitamin and calcium biweekly. Room temperatures are set to 22-24ºC, but to ensure a temperature gradient, we employ a heat chord and a heat lamp following a 12 h light:12 h dark cycle, keeping the warm side of enclosures at 32ºC.  

*Eggs collection and incubation* -- Between mid-October 2023 to the end of February 2024, we placed small boxes (12.5 L x 8.3 W x 5 H cm) with moist vermiculite inside in one extreme of the communal enclosures (see above) to provided females with a place to lay the eggs. We checked for the presence of eggs in the boxes three days a week. Eggs' length and width were measured with a digital caliper to the nearest 0.1 mm, while mass was recorded with a (OHAUS, Model spx123) digital scale ± 0.001g error. Eggs were assigned a clutch number and a individual identity. Then we treated eggs with CORT or vehicle (see CORT and Temperature manipulation below) and placed them in individual cups (80 mL) with moist vermiculite (12 parts water to 4 parts vermiculite). We covered the cups with cling wrap to retain moisture and then left the eggs in LATWIT 2X5D-R1160 incubators at two different temperatures (see CORT and Temperature manipulation below) until hatching.  

*Hatchlings* -- Incubators were checked three times a week for the presence of hatchlings. Once hatchlings were collected, we measured SVL and Tail Length (TL) with a ruler to the nearest mm, and weighed them with a (OHAUS, Model spx123) digital scale ± 0.001g error. Hatchlings were then placed in individual enclosures (18.7L x 13.2W x 6.3H cm) provided with non-stick matting and a small water dish. During this period, they were sprayed water every day and received 3-6 small *A. domestica* crickets three times a week. All care otherwise follows similar protocols to adults (see above).  


#### Manipulating Early Thermal and CORT Environments  

We manipulated CORT concentration in eggs and incubated them under one of two temperature regimes (Cold -- 23ºC ± 3ºC or Hot -- 30ºC ± 3ºC) in a 2x2 factorial design (@fig-Methods A). We first allocated eggs onto one of two different treatments: in the CORT treatment, eggs were topically supplied with 5µL of CORT dissolved in 100% Ethanol (vehicle) at a final (10 pg CORT/mL) concentration; in the Control treatment eggs received an equal volume of the vehicle. CORT concentration employed in the CORT treatment represents 2 standard deviations above the mean natural concentration obtained in eggs from both species (non-published data). Then, eggs were incubated in one of the two previously mentioned temperature regimes (Cold or Hot) until hatching. This temperatures represent the upper and lower limit of the natural incubation temperatures [@qualls2000post]. The number of eggs per clutch assigned to each hormone and temperature treatment were counterbalanced in both species.  

#### Numerical discrimination task  

Two weeks before starting the experimen phase (see below), lizards were moved to the experimental arena for acclimatation. The arenas were individual medium size (41 L x 29.7 W x 22 H cm) plastic containers provided with a shelter (9 L x 6 W x 1.5 H cm) on one of the extremes and a water dish on the center (@fig-Methods B). The new enclosures were placed in 7 different racks located in two different rooms. Each rack was associated to its own CCTV systems (device model DVR-HP210475) allowing us to record lizards' behaviour during the experiment. The number of lizards per species and treatment in each rack was counterbalanced to control for any effect of the room or the position of the lizard in the rack. During acclimatation and throughout the experiment, lizards were fed with only one cricket per day dusted with calcium and multivitamin (see protocol below), and water was supplied *ad libitum*. The temperature of both rooms was set to between 22-24ºC, but we also provided a temperature gradient by means of a heat cord along the center of the arena, and heat lamps in a 12 h light: 12 h dark cycle.  

The numerical discrimination test consisted in a series of two-choice trials where lizards where presented with different number of food items. Each choice was placed in one of two sides of a white 3D printed platform (see @fig-Methods B, C) and then covered with a transparent Petri dish to prevent the lizard from obtaining the food. We performed five tests that differed in the ratio between both choices: 1 VS 4, 1 VS 3, 2 VS 4, 2 VS 3, 3 VS 4. We never used more than four items because higher numbers are considered to be encoded by different regions of the brain [**REFs**]. The food consisted in frozen small crickets (*A. domestica*) that were thawed and dusted with calcium and multivitamin. We decided to use frozen crickets to avoid movement to affect lizards' behaviour. Lizards were fed frozen crickets during one month before the beginning of the experiments for habituation to frozen prey. Two weeks before the experiments, to habituate lizards to the platform and the Petri dish, the frozen cricket that was placed on top of the Petri dish in one of the sides of the platform, simulating the conditions of the experiment (see @fig-Methods B). The side where the food was placed was changed every day to avoid any side bias during the trials. However, to further control for that, the side where we placed the higher number of crickets was randomised between trials and individuals. We also counterbalanced the amount of individuals per treatment tested in the same type of trial each day. The crickets used during the experiment were all the same size, but to control for other quantitative traits 
[**REFs In this regard, we must remark that, in our design, we did not control for other quantity-related continuous cues such as area, volume, density, weight, movement, or contour length that could be used for quantitative judgments (Uller et al. 2003; Krusche et al. 2010; Abramson et al. 2011; Garland et al. 2012; Vonk and Beran 2012; Gómez-Laplaza and Gerlai 2013; Mehlis et al. 2015), neither for olfactory cues (Plotnik et al. 2019). These continuous variables usually covariate with quantity, but discrimination among them does not necessarily imply processment of numerical information (Agrillo and Bissaza 2014).**]
, we changed the orientation of the crickets as shown in @fig-Methods D. In addition, after the experiments, we made another set of trials to test whether the orientation of the crickets could affect lizards' choice, but we found no effect of orientation (see Supplementary Material - Prey orientation test).  

All tests were done between 10 and 12 in the morning when the lizards were most active. Each trial was performed daily for five days, between the 17^th^ to the 22^nd^ of May 2024. We recorded three main variables: i) Latency, defined as the time between the start of the test - when the platform was left in the enclosure - until the first interaction with one of the options; ii) First choice of the lizard, recorded as 1 if the lizard interacted first with the larger amount or 0 if not; and iii) Interest shown for the higher amount of food (detailed below). We considered that the lizard was interacting with the food when it touched the Petri dish with its snout or when the front half of the body was on top of the platform. For five minutes after the first interaction with one of the options, we recorded the time spent interacting with that option for a maximum of five minutes; we did this for both amounts of food independently of what was the first choice. We measured the interest shown for the higher amount of food by substracting the time interacting with the option with less crickets to the time spent interacting with the larger amount of food. If there was no interaction with one of the options during the test, we considered the time spent as 0 for that option. When there was no interaction with any of the choices, both Latency, First choice, and Interest were noted as NA. We also considered Interest as NA in some few cases where the animals managed to lift the dish and eat the prey; Latency and First choice were recorded and employed in the analyses. We excluded from the analyses all the individuals that did not make any choice in three or more tests.   

```{r, fig-Methods}
#| label: fig-Methods
#| fig.cap: "Experimental design of early environment manipulation (**A**), numerical discrimination arena an measures(**B**), measures of the platform used for the experiments (**C**), and types of numerical trial (**D**), where each line indicates the position and orientation of the food items in each test."

knitr::include_graphics("./Others/NUMDIS_FIG_1.png")

```

#### Statistical analyses  
INT This gave as a gradient from -300 to +300 where the minimum represents interest in the lower amount of food and the maximum shows a preference towards higher number of crickets, while 0 shows no discrimination between them.
**We performed the analyses for each species separately. We fitted two different Bayesian multilevel models using the brm function from the _brms_ package [@burkner2017brms] using an R extension (version 2.8.2) [@R]. We ran four parallel MCMC chains of 3000 iterations for each model, with a warmup period of 1000 iterations. We modelled correct choices [correct (1) or not (0)] as the response variable, and trial, hormone (CORT versus Control), incubation temperature (Cold versus Hot), and their interaction as fixed factors. We included a random intercept and slope (trial) for each lizard in our models. We also incorporated the clutch identity as a random factor. We used the posterior distributions of parameters from these models to test for differences in learning rate between treatments and species. Learning slopes were obtained using the ‘trial’ estimates and its interaction with hormone and temperature treatments. Slope estimates greater than zero were considered as evidence of learning, while those less or equal to zero were not. We calculated the probability that slopes or contrasts between slopes differed from zero (p~mcmc~) using the posterior distributions. We considered statistical significance if p~mcmc~  < 0.05.**  
 
#### Ethical note
Subjects were collected from a breeding colony kept in the lab since 2019. All animals used in this experiment were provided humane laboratory housing, with thermorregulation opportunity, light, and humidity conditions (see above for details). Lizards in the colony received five-seven crickets per individual three times a week while the subjects in the experiment were fed once per day. All lizards were handled minimally to avoid stress. Experimental procedures and laboratory housing complied with Australian law and were approved by the Australian National University Animal Experimentation Ethics Committee (A2022_33). Upon completion of experimental trials, lizards were kept in their enclosure until they were euthanized following standard humane procedures.  
 

## Results

```{r, data_process}
#| label: data_process
# Load the data and process it to get the main dfs
source(here("R", "data_process.R"))
```

```{r, sampleSize}
#| label: sampleSize
# List with the sample sizes from the database (here("output/databases_clean/data_asso.csv") as the sample size per species and group is the same on each task. We used function sample (see func.R) to estimate the sample size per treatment and species.
source(here("R", "func.R"))
#
hormone <- c("CORT", "Control")
temperature <- c("Cold", "Hot")
side <- c("Right", "Left")
#
n_list <- list()
#
for(k in 1:length(hormone)){
  for(l in 1:length(temperature)){
    for(i in 1:length(side)){
      n_list[[paste(hormone[k], temperature[l], side[i], sep = "_")]] <- sample(hormone[k], temperature[l], side [i])
    }
  }
}
```

```{r, models}
#| label: models
# Fitting the model and extraction of posteriors 
refit = FALSE
if(refit){
  # Get the formula and family of variables
  lat <- bf(log(latency) ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = gaussian())
  choice <- bf(choice ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch), family = bernoulli(link = "logit"))
  int <- bf(compared_interest ~ test_type*temp*cort + sex + age + (1|lizard_id) + (1|clutch),
    family = gaussian())
  # Fit the model
  model <- brm(lat + choice + int,
                chains = 4, cores = 4, iter = 3000, warmup = 1000, control = list(adapt_delta = 0.99, max_treedepth =12),
                data = data_num)
    # Write the model to a file
    saveRDS(model, file = here("output/models/model_num.rds"))
  } else {
      # Read the model from a file
      model <- readRDS(file = here("output/models/model_num.rds"))
  } 
# 
```

```{r, posteriors}
#| label: posteriors
# Code to extract posteriors from the model and get predicted values
source(here("R", "func.R"))
#
## Extract posteriors
posteriors <- as_draws_df(model)
# 
## Get predictions for every test and treatment based on the posteriors of the model. We used the function org_post (see func.R) to get the predictions.
#
# Latency
post_lat <- org_post("lat")
# Choice
post_choice <- org_post("choice")
prob_choice <- exp(post_choice)/(1 + exp(post_choice))
# Estimated interest for the higher amount of food
post_int <- org_post("int")
#
```

Include here general text: Results are in Table 1 and figure X.

Preliminary results showed: talk about sex and age, refer to summary (prepare that), and explain how did we control by that.

_Table 1. Estimates of the effects of each treatment and their interaction on the latency, choice, and interest shown for the higher amount of food in each of the numerical discrimination tests. The table shows the comparissons for each predictor and the p~mcmcm~ value of the comparissons. In bold, the estimates with p~mcmc~ < 0.05._
```{r, tbl-data}
#| label: tbl-data
#| tbl-cap: "Estimates of the effects of each treatment and their interaction on the latency, choice, and interest shown for the higher amount of food in each of the numerical discrimination tests. The table shows the comparissons for each predictor and the p~mcmcm~ value of the comparissons. In bold, the estimates with p~mcmc~ < 0.05."
source(here("R", "func.R"))
#
# Making the df for each variable
#
## Initialize df_org as a list to store data frames for each variable
df_org <- list()
## Define variables and tests
variable <- c("Latency", "Choice", "Interest")
test <- c("1VS4", "1VS3", "2VS4", "2VS3", "3VS4")
## Loop over each variable
for(a in variable){
  # Select the original df to use depending on the variable
  if(a == "Latency"){
    post <- post_lat
  } else if(a == "Choice"){
    post <- prob_choice
  } else if(a == "Interest"){
    post <- post_int
  }
  df_tables <- data.frame()
  for(b in test){
    # Modify the df to get the values per each test
    post_mod <- post %>%
      dplyr::select(dplyr::matches(b))
    # Extract the required columns
    Cold_CORT <- post_mod[[paste0("X", b, "_Cold_CORT")]]
    Cold_Control <- post_mod[[paste0("X", b, "_Cold_Control")]]
    Hot_CORT <- post_mod[[paste0("X", b, "_Hot_CORT")]]
    Hot_Control <- post_mod[[paste0("X", b, "_Hot_Control")]]
    # Calculate effects and pmcmc values
    effect_temp <- format_dec(mean(c(Hot_CORT, Hot_Control)) - mean(c(Cold_CORT, Cold_Control)), 3)
    effect_hormone <- format_dec(mean(c(Hot_Control, Cold_Control)) - mean(c(Hot_CORT, Cold_CORT)), 3)
    interaction <- format_dec((mean(Hot_Control) - mean(Cold_Control)) - (mean(Hot_CORT) - mean(Cold_CORT)), 3)
    #
    pmcmc_temp <- format_p(pmcmc(c(Hot_CORT, Hot_Control) - c(Cold_CORT, Cold_Control)), 3)
    pmcmc_hormone <- format_p(pmcmc(c(Hot_Control, Cold_Control) - c(Hot_CORT, Cold_CORT)), 3)
    pmcmc_interaction <- format_p(pmcmc((Hot_Control - Cold_Control) - (Hot_CORT - Cold_CORT)), 3)
    # Define labels and values
    effects_predictors_names <- c("Temperature", 
                          "Hormone", 
                          "Interaction")
    values_predictors <- c(effect_temp, effect_hormone, interaction)
    values_pmcmc <- c(pmcmc_temp, pmcmc_hormone, pmcmc_interaction)
    # Create a temporary data frame for this loop iteration
    temporal_df <- data.frame(Predictor = effects_predictors_names,
                        Effect = values_predictors,
                        pmcmc = values_pmcmc,
                        Test = b,
                        stringsAsFactors = FALSE)
    # Merge the temporary data frame to the main df_tables
    df_tables <- rbind(df_tables, temporal_df)
  }
  df_tables$Variable <- a
  df_org[[a]] <- df_tables
}
# Combine all data frames in df_org into one data frame
table_df <- do.call(rbind, df_org)
# Convert the combined list into a data frame and modify for the table
table_df <- as.data.frame(table_df, stringsAsFactors = FALSE) %>%
  mutate(results = paste(Effect, "(p", pmcmc, ")")) %>%
  dplyr::select(Variable, Test, Predictor, results) %>%
  pivot_wider(names_from = Test, values_from = c(results), names_prefix = "")
#
#
# Making the table
#
## Table format
set_flextable_defaults(
 font.family = "Arial",
 fint.size = 10)
# Split the table_data df by task
real_table <- flextable(table_df) %>%
    set_table_properties(width = 1) %>%
    align(align="center", part="all") %>% 
    add_header_row(values = c("", "Tests"), colwidths = c(2, 5)) %>%
    flextable::compose(i = c(2,3,5,6,8,9), j = 1, value = as_paragraph(""), part = "body") %>% # To remove some of the values in the first column
    hline(i = c(3,6), j = c(1:7), part = "body") %>% # To make some horizontal lines
    vline(i = (1:9), j = c(2:6), part = "body") %>% # To make some vertical lines on body
    vline(i = 2, j=c(2:6), part = "header") %>% # To make some vertical lines on header
    autofit() 
real_table
```

Results: Latency, Choice, and Interest for each test and treatment, references to fig x and Table 1. Basically, no effects of treatment on the performance of the numerical discrimination task. no discrimination either (refer to Table in Suppl. Material).

```{r, fig-results}
#| label: fig-results
#| fig.cap: "" 
```


## Discussion
- Animals do not discriminate independently of the treatment or the ratio of the numerical task.
  - Other studies about discrimination
  - The importance of context
    - Learned VS spontaneous discrimination
There are two main approaches to study numerical abilities: spontaneous choice tests and training procedures. In spontaneous choice tests, experimenters present to subjects two groups of biologically relevant stimuli that differ in numerosity, under the assumption that animals should select the most appropriate quantity (e.g. the larger amount of food) (Agrillo and Bisazza 2014; Cox and Montrose 2016). In training
procedures, animals must learn a numerical rule to receive a reward (Agrillo and Bisazza 2014; Miletto-Petrazzini et al. 2018). Both experimental approaches have some advantages and disadvantages (reviewed in Agrillo and Bisazza 2014). In spontaneous choice tests, animals exhibit their natural behavior, enabling interspecific comparisons and the acquirement of ecological issues related to numerousness (Krusche et al. 2010; Abramson et al. 2011). However, motivation plays a key-role in spontaneous choice tests (Agrillo and Bisazza 2014), which implies that the absence of results might not be due to the lack of skills to solve the numerical task. Also, individual preferences may arise in this kind of procedures and, hence, a large sample of subjects is needed to consider inter-individual variability. Finally, it could be difficult, but necessary, to control for continuous variables such as area, density or movement (Agrillo and Bisazza 2014; Mehlis et al. 2015). Regardless, both methods are considered complementary and necessary to draw a firm picture of the numerical abilities of a species (Miletto-
Petrazzini et al. 2018). the Italian wall-lizard (Podarcis siculus), spontaneous choice tests showed no numerical discrimination abilities by this lizard (Miletto-Petrazzini et al. 2017), although learning procedures demonstrated an ability to discern between small close numbers (2 versus 4) (Miletto-Petrazzini et al. 2018)
    - Ecological context: food VS predators/conspecifics/etc 
Something with fishes, food, and conspecifics (**check our paper**)
    
- Treatment did not affect the discrimination capacity or the decision making
  - Other studies showing the effect of temperature on discrimination
  - Other studies about the effects of hormones on discrimination
  - Studies showing the effect of temperature and CORT on lizards' cognition
  - The 'two systems'
Researchers have suggested that numerousness can be processed by two types of systems: one system for small sets (≤ 4) that works by tracking and encoding objects as individual entities; and an analogous system that operates with large numerosities by estimation processes (for a review see Cantlon et al. 2009; Hyde 2011). **Are they encoded in different regions? Brin-nuclei-dependent effects of CORT and temp** 

- Conclusions

## References
<div id="refs"></div>

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

# Suplementary Material

#### Preliminary results

_Table S1.- Summary of the model_

```{r, tbl-summary}
#| label: tbl-summary
#| tbl-cap: "Summary of the model fitted to the data."
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Treatments effects

_Table S2.- Evaluating whether choice diff from 0.5 and interest diff from 0_
```{r, tbl-summary}
#| label: tbl-summary
#| tbl-cap: "Summary of the model fitted to the data."
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Testing potential side biases

_Table S3.- Number of individuals per treatment that chose the right (R) or left (L) side in each of the numerical tests. p-value indicates the result of the binomial test comparing the number of choices between sides._
```{r, tbl-sides}
#| label: tbl-sides
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_sides <- data_num %>%
  group_by(trt, test_type) %>% # Group by treatment and test
  summarise(
    right_choices = sum(side_choice == "Right", na.rm = TRUE),
    left_choices = sum(side_choice == "Left", na.rm = TRUE),
  ) %>% # Count the number of correct choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = right_choices + left_choices,  # Calculate total choices
    p_value = format_dec(binom.test(right_choices, total_choices)$p.value, 2)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(choices_Right_Left_p = paste0("R = ", right_choices, " | L = ", left_choices, " , p = ", p_value), # Create a column with the choices
        trt = recode(trt, 
                 "B_23" = "CORT-Cold (n = 20)", 
                 "A_23" = "Control-Cold (n = 20)", 
                 "B_28" = "CORT-Hot (n = 20)", 
                 "A_28" = "Control-Hot (n = 20)")) %>% # To order the treatments
  dplyr::select(trt, test_type, choices_Right_Left_p) %>% # Remove unused columns
  pivot_wider(names_from = test_type, values_from = c(choices_Right_Left_p)) %>% # To split between tests
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
sides_table <- flextable(data_sides) %>%
  compose(j = 1, value = as_paragraph(""), part = "header") %>%
  compose(j = 2, value = as_paragraph("1 VS 4"), part = "header") %>%
  compose(j = 3, value = as_paragraph("1 VS 3"), part = "header") %>%
  compose(j = 4, value = as_paragraph("2 VS 4"), part = "header") %>%
  compose(j = 5, value = as_paragraph("2 VS 3"), part = "header") %>%
  compose(j = 6, value = as_paragraph("3 VS 4"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
sides_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Prey orientation test
Because we were concerned that the orientation of the crickets could affect the lizards' choice, we performed one simple choice test to investigate this. We used the same platform and Petri dish as in the numerical discrimination task, but we placed one cricket on each side of the platform, one oriented vertically in respect to the shelter position (see @fig-Methods B) and the other one horizontal to the shelter. We perform a unique trial randomising the position of the orientation of the cricket. We recorded the amount of individuals that chose the cricket oriented vertically and horizontally. Results are shown in the table below.

_Table S4. Number of individuals per treatment that chose the cricket oriente horizontally (Horizontal) or vertically (Vertical) in our control tests. p-value indicates the result of the binomial test comparing the number of choices between both choices._
```{r, tbl-orientation}
#| label: tbl-sides
source(here("R", "func.R"))
#
# 1) MAKING THE DF FOR THE TABLE
data_or_res <- data_orient %>%
  mutate(choice_or = ifelse(choice_horizontal == 0, "Vertical", "Horizontal")) %>%
  dplyr::select(trt, choice_horizontal, choice_or) %>%
  group_by(trt) %>% # Group by treatment and test
  summarize(
    Horizontal_Count = sum(choice_or == "Horizontal"),
    Vertical_Count = sum(choice_or == "Vertical")
  ) %>% # Count the number of horizontal and vertical choices
  rowwise() %>%  # Ensure that mutate works row by row
  mutate(
    total_choices = Horizontal_Count + Vertical_Count,  # Calculate total choices
    p_value = format_dec(binom.test(Horizontal_Count, total_choices)$p.value, 3)  # Perform binom test
  ) %>% # Test for differences between sides
  ungroup() %>%  # Remove rowwise grouping
  mutate(trt = recode(trt, 
            "B_23" = "CORT-Cold (n = 20)", 
            "A_23" = "Control-Cold (n = 20)", 
            "B_28" = "CORT-Hot (n = 20)", 
            "A_28" = "Control-Hot (n = 20)")) %>% # To order the treatments
  dplyr::select(trt, Horizontal_Count, Vertical_Count, p_value) %>% # Remove unused columns
data.frame()
#
# 2) MAKING THE TABLE
#
# Split the table_data df by task
orient_table <- flextable(data_or_res) %>%
  compose(j = 1, value = as_paragraph(""), part = "header") %>%
  compose(j = 2, value = as_paragraph("Horizontal"), part = "header") %>%
  compose(j = 3, value = as_paragraph("Vertical"), part = "header") %>%
  compose(j = 4, value = as_paragraph("p-value"), part = "header") %>%
  set_table_properties( width = 0.9, layout = "autofit") %>%
  align(align = "center", part = "all")
orient_table
```

```{r, results='asis', echo=FALSE}
cat("\\newpage")
```

#### Checking the models plots  
```{r, checking_model, out.width="70%", fig.align="center"}
# Chunk for plotting the model
## Initial plot
plot(model)
#
## pp_checks
pp_check(model, resp = "loglatency")
pp_check(model, resp = "choice")
pp_check(model, resp = "comparedinterest")
```
